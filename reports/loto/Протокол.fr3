<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39554,5208128935" ReportOptions.Description.Text="" ReportOptions.LastChange="39554,5208128935" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  FPublishingId: Variant;                                                   &#13;&#10;  FUssueId: Variant;&#13;&#10;&#13;&#10;procedure ButtonPublishingOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if DataSelectInto('Издания',ProviderPublishing,'PUBLISHING_ID',FPublishingId) then begin&#13;&#10;    FPublishingId:=ProviderPublishing.FieldByName('PUBLISHING_ID').Value;&#13;&#10;    EditPublishing.Text:=ProviderPublishing.FieldByName('NAME').AsString;&#13;&#10;    MemoPublishing.Text:=EditPublishing.Text;                      &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButtonIssueOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  FilterGroups: TBisFilterGroups;                                                                            &#13;&#10;begin&#13;&#10;  FilterGroups:=TBisFilterGroups.Create;&#13;&#10;  try&#13;&#10;    ProviderIssue.FilterGroups.Clear;&#13;&#10;    if FPublishingId&#60;&#62;Null then                                          &#13;&#10;      ProviderIssue.FilterGroups.Add.Filters.Add('PUBLISHING_ID',fcEqual,FPublishingId);                                &#13;&#10;    if DataSelectInto('Выпуски',ProviderIssue,'ISSUE_ID',FUssueId) then begin&#13;&#10;      FUssueId:=ProviderIssue.FieldByName('ISSUE_ID').Value;&#13;&#10;      EditDateBegin.Date:=ProviderIssue.FieldByName('DATE_BEGIN').AsDateTime;&#13;&#10;      EditDateEnd.Date:=ProviderIssue.FieldByName('DATE_END').AsDateTime;&#13;&#10;  &#13;&#10;      FPublishingId:=ProviderIssue.FieldByName('PUBLISHING_ID').Value;&#13;&#10;      EditPublishing.Text:=ProviderIssue.FieldByName('PUBLISHING_NAME').AsString;                                                    &#13;&#10;    &#13;&#10;      MemoPublishing.Text:=EditPublishing.Text;                                                                                   &#13;&#10;    end;&#13;&#10;  finally&#13;&#10;    FilterGroups.Free;                                                   &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButtonOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Trim(EditPublishing.Text)='' then begin&#13;&#10;    ShowError('Выберите издание');&#13;&#10;    EditPublishing.SetFocus;                                &#13;&#10;  end else begin&#13;&#10;    Provider.Params.Clear;&#13;&#10;    Provider.Params.&#13;&#10;    Add('PUBLISHING_ID',ptInput).Value:=FPublishingId;&#13;&#10;    Provider.Params.Add('DATE_BEGIN',ptInput).Value:=EditDateBegin.Date;                              &#13;&#10;    Provider.Params.Add('DATE_END',ptInput).Value:=EditDateEnd.Date;&#13;&#10;&#13;&#10;    MemoBegin.Text:=VarToStrDef(EditDateBegin.Date,'');                                                 &#13;&#10;    MemoEnd.Text:=VarToStrDef(EditDateEnd.Date,'');&#13;&#10;      &#13;&#10;    DialogPage.ModalResult:=mrOk;&#13;&#10;  end;              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPageOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;                                                          &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  FPublishingId:=Null;                             &#13;&#10;  FUssueId:=Null;&#13;&#10;  EditPublishing.Color:=$00E4E4E4;                                  &#13;&#10;  EditDateBegin.Color:=clWindow;&#13;&#10;end." PropData="08446174617365747301010C2A00000020446174615365743D2250726F76696465722220446174615365744E616D653D2250726F76696465722200010C2F00000020446174615365743D2250726F766964657249737375652220446174615365744E616D653D2250726F76696465722200010C3E00000020446174615365743D2250726F76696465725075626C697368696E672220446174615365744E616D653D2250726F76696465725075626C697368696E67220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="Provider" UserName="Provider" CloseDataSource="True" FieldAliases.Text="WHO_NAME=WHO_NAME&#13;&#10;FIRM_SMALL_NAME=FIRM_SMALL_NAME&#13;&#10;USER_NAME=USER_NAME&#13;&#10;AMOUNT=AMOUNT" ProviderName="P_AMOUNT_ALL" FetchCount="-1" OpenMode="omExecute" PropData="05704C65667402380470546F700234"/>
    <TBisProvider Name="ProviderIssue" UserName="Provider" CloseDataSource="True" FieldAliases.Text="" FetchCount="-1" OpenMode="omOpen" PropData="05704C65667402480470546F70039800"/>
    <TBisProvider Name="ProviderPublishing" UserName="ProviderPublishing" CloseDataSource="True" FieldAliases.Text="PUBLISHING_ID=PUBLISHING_ID&#13;&#10;NAME=NAME&#13;&#10;DESCRIPTION=DESCRIPTION&#13;&#10;PRIORITY=PRIORITY" FetchCount="-1" OpenMode="omOpen" PropData="05704C65667402480470546F7003E800"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="5" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxHeader Name="Header" Height="26,45671" Left="0" Top="151,1812" Width="718,1107" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="151,1812" Height="18,89765" Color="-16777201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљС‚Рѕ РІРІРµР»"/>
      <TfrxMemoView Name="Memo7" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" Color="-16777201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
      <TfrxMemoView Name="Memo11" Left="396,85065" Top="0" Width="245,66945" Height="18,89765" Color="-16777201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЈС‡РµС‚РЅР°СЏ Р·Р°РїРёСЃСЊ"/>
      <TfrxMemoView Name="Memo16" Left="151,1812" Top="0" Width="245,66945" Height="18,89765" Color="-16777201" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЂРіР°РЅРёР·Р°С†РёСЏ"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData" Height="18,89765" Left="0" Top="241,88992" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="Provider" DataSetName="Provider" RowCount="0">
      <TfrxMemoView Name="Memo27" Left="151,1812" Top="0" Width="566,9295" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Highlight.Font.Charset="1" Highlight.Font.Color="255" Highlight.Font.Height="-13" Highlight.Font.Name="Arial" Highlight.Font.Style="0" Highlight.Color="15793151" Highlight.Condition="&#60;Line#&#62; mod 2 = 0" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo12" Left="151,1812" Top="0" Width="245,66945" Height="18,89765" DataField="FIRM_SMALL_NAME" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="4" ParentFont="False" Text="[Provider.&#34;FIRM_SMALL_NAME&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="396,85065" Top="0" Width="245,66945" Height="18,89765" DataField="USER_NAME" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="4" ParentFont="False" Text="[Provider.&#34;USER_NAME&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" DataField="AMOUNT" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="4" HAlign="haRight" ParentFont="False" Text="[Provider.&#34;AMOUNT&#34;]"/>
    </TfrxMasterData>
    <TfrxReportTitle Name="ReportTitle" Height="71,81107" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="287,24428" Top="0" Width="136,06308" Height="26,45671" AutoWidth="True" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРѕС‚РѕРєРѕР»"/>
      <TfrxMemoView Name="Memo3" Left="230,55133" Top="37,7953" Width="109,60637" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Р·Р° С‚РёСЂР°Р¶:"/>
      <TfrxMemoView Name="MemoBegin" Left="347,71676" Top="37,7953" Width="181,41744" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter" Height="22,67718" Left="0" Top="411,96877" Width="718,1107">
      <TfrxMemoView Name="Memo5" Left="642,5201" Top="3,77953000000002" Width="79,37013" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Page]"/>
    </TfrxPageFooter>
    <TfrxFooter Name="Footer" Height="26,45671" Left="0" Top="325,03958" Width="718,1107">
      <TfrxMemoView Name="Memo8" Left="642,5201" Top="7,55905999999999" Width="75,5906" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" GapX="4" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Provider.&#34;AMOUNT&#34;&#62;,MasterData)]"/>
      <TfrxMemoView Name="Memo9" Left="578,26809" Top="7,55905999999999" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="Р’СЃРµРіРѕ:"/>
      <TfrxLineView Name="Line2" Left="578,26809" Top="7,55905999999999" Width="139,84261" Height="0" Frame.Typ="4" Frame.Width="2"/>
    </TfrxFooter>
    <TfrxGroupHeader Name="GroupHeader" Height="18,89765" Left="0" Top="200,31509" Width="718,1107" Condition="Provider.&#34;WHO_NAME&#34;" PrintChildIfInvisible="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="718,1107" Height="18,89765" Color="-16777186" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="642,5201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="4" ParentFont="False" Text="[Provider.&#34;WHO_NAME&#34;]"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter" Height="18,89765" Left="0" Top="283,46475" Width="718,1107">
      <TfrxMemoView Name="Memo15" Left="585,82715" Top="0" Width="56,69295" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" Text="РС‚РѕРіРѕ:"/>
      <TfrxMemoView Name="Memo17" Left="642,5201" Top="0" Width="75,5906" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="4" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Provider.&#34;AMOUNT&#34;&#62;,MasterData)]"/>
      <TfrxLineView Name="Line1" Left="585,82715" Top="0" Width="132,28355" Height="0" Frame.Typ="4"/>
    </TfrxGroupFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Статистика общая" Height="136" Left="326" Top="176" Width="326" OnClick="DialogPageOnClick">
    <TBisLabelControl Name="LabelBegin" Left="13" Top="43" Width="50" Height="13" Alignment="taRightJustify" Caption="Период с:" Color="-16777201" FocusControl="EditDateBegin"/>
    <TBisLabelControl Name="LabelEnd" Left="176" Top="44" Width="16" Height="13" Alignment="taRightJustify" Caption="по:" Color="-16777201" FocusControl="EditDateEnd"/>
    <TBisEditControl Name="EditPublishing" Left="68" Top="12" Width="213" Height="21" Color="-16777192" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxButtonControl Name="ButtonPublishing" Left="288" Top="12" Width="21" Height="21" Hint="Выбрать издание" Caption="..." OnClick="ButtonPublishingOnClick"/>
    <TBisEditDateControl Name="EditDateBegin" Left="68" Top="40" Width="85" Height="21" Color="-16777192" Text="  .  .    "/>
    <TBisEditDateControl Name="EditDateEnd" Left="196" Top="40" Width="85" Height="21" Color="-16777211" Text="  .  .    "/>
    <TBisLabelControl Name="LabelPublishing" Left="16" Top="15" Width="47" Height="13" Alignment="taRightJustify" Caption="Издание:" Color="-16777201" FocusControl="EditPublishing"/>
    <TfrxButtonControl Name="ButtonIssue" Left="288" Top="40" Width="21" Height="21" Hint="Выбрать выпуск" Caption="..." OnClick="ButtonIssueOnClick"/>
    <TfrxButtonControl Name="ButtonOk" Left="155" Top="76" Width="75" Height="25" Caption="ОК" Default="True" OnClick="ButtonOkOnClick"/>
    <TfrxButtonControl Name="ButtonCancel" Left="236" Top="76" Width="75" Height="25" Cancel="True" Caption="Отмена" ModalResult="2"/>
  </TfrxDialogPage>
</TBisFastReport>
