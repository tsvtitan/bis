<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39645.6351349074" ReportOptions.Description.Text="" ReportOptions.LastChange="39919.4628520949" ScriptLanguage="PascalScript" ScriptText.Text="var               &#13;&#10;  FAccountId: Variant;&#13;&#10;  OrderNum: String;                                                               &#13;&#10;  FPeriodType: TBisPeriodType;&#13;&#10;  zoneIdList: TStringList;&#13;&#10;  ZoneName: String;&#13;&#10;  PageNum: Integer;&#13;&#10;    &#13;&#10;procedure ButtonOkOnClick(Sender: TfrxComponent);&#13;&#10;var   &#13;&#10;  CCount: Integer;&#13;&#10;  i: Integer;&#13;&#10;  DriverId: String;&#13;&#10;  DriverIdIndex: Integer;                                     &#13;&#10;begin&#13;&#10;  Provider.Params.Clear;&#13;&#10;  Provider.Params.Add('DATE_BEGIN',ptInput).Value:=EditDateBegin.Date;&#13;&#10;  Provider.Params.Add('DATE_END',ptInput).Value:=EditDateEnd.Date;&#13;&#10;&#13;&#10;  WriteParam('Count_Sms_Out_Orders_Details','Date_begin',EditDateBegin.Date);&#13;&#10;  WriteParam('Count_Sms_Out_Orders_Details','Date_end',EditDateEnd.Date);&#13;&#10;   WriteParam('Count_Sms_Out_Orders_Details','Contact',EditContact.Text);      &#13;&#10;&#13;&#10;      if Length(EditContact.Text) &#60;&#62; 0 then begin&#13;&#10;      MemoTitle.Text:='Детализация исходящих сообщений получателю: ' + EditContact.Text;&#13;&#10;      Provider.Params.Add('CONTACT',ptInput).Value:=EditContact.Text;          &#13;&#10;      end else begin&#13;&#10;      MemoTitle.Text:='Детализация исходящих сообщений всем получателям';                       &#13;&#10;      end;      &#13;&#10;          &#13;&#10;      if EditDateEnd.Date &#60;&#62; null then begin&#13;&#10;      MemoTitle2.Text :=  'за период по ' + EditDateEnd.Text;&#13;&#10;      end;&#13;&#10;        &#13;&#10;      if EditDateBegin.Date &#60;&#62; null then begin                           &#13;&#10;      MemoTitle2.Text :=  'за период с ' + EditDateBegin.Text;&#13;&#10;      end;&#13;&#10;        &#13;&#10;      if (EditDateBegin.Date = null) AND (EditDateEnd.Date = null) then begin &#13;&#10;      MemoTitle2.Text := 'за весь период'; end;&#13;&#10;&#13;&#10;      if (EditDateBegin.Date &#60;&#62; null) AND (EditDateEnd.Date &#60;&#62; null) then begin &#13;&#10;      MemoTitle2.Text := 'за период с ' + EditDateBegin.Text + ' по ' + EditDateEnd.Text; end;&#13;&#10;        &#13;&#10;  DialogPage.ModalResult:=mrOk;   &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButtonCancelOnClick(Sender: TfrxComponent);&#13;&#10;begin                       &#13;&#10;&#13;&#10;end;    &#13;&#10;&#13;&#10;procedure ButtonPeriodOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D1,D2: TDateTime;                                            &#13;&#10;begin&#13;&#10;  D1:=EditDateBegin.Date;&#13;&#10;  D2:=EditDateEnd.Date;                              &#13;&#10;  if PeriodSelect(FPeriodType,D1,D2) then begin&#13;&#10;    EditDateBegin.Date:=D1;&#13;&#10;    EditDateEnd.Date:=D2;                      &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButonContactOnClick(Sender: TfrxComponent);&#13;&#10;begin  &#13;&#10;  if DataSelectInto('Учетные записи',ProviderContact,'PHONE',FAccountId,false) then begin&#13;&#10;    FAccountId:=ProviderContact.FieldByName('PHONE').AsString;                                                                     &#13;&#10;    if FAccountId &#60;&#62; null then begin&#13;&#10;       EditContact.Text := VarToStr(FAccountId);                                                       &#13;&#10;    end            &#13;&#10;  end;            &#13;&#10;end;      &#13;&#10;    &#13;&#10;      &#13;&#10;  &#13;&#10;var     &#13;&#10;  DriverId: String;&#13;&#10;  Index: Integer; &#13;&#10;  Obj: TObject;&#13;&#10;  tmp: String;                             &#13;&#10;  S: String;&#13;&#10;  Checked: Boolean;&#13;&#10;begin      &#13;&#10;  FPeriodType:=ptMonth; &#13;&#10;  EditDateBegin.Color:=clWindow;&#13;&#10;  EditDateBegin.Date:=ReadParam('Count_Sms_Out_Orders_Details','Date_begin',EditDateBegin.Date);&#13;&#10;  EditDateEnd.Color:=clWindow;  &#13;&#10;  EditDateEnd.Date:=ReadParam('Count_Sms_Out_Orders_Details','Date_end',EditDateBegin.Date);&#13;&#10;  EditDateEnd.Color:=clWindow;  &#13;&#10;  EditContact.Text:=ReadParam('Count_Sms_Out_Orders_Details','Contact',EditContact.Text);      &#13;&#10;end." PropData="08446174617365747301010C2A00000020446174615365743D2250726F76696465722220446174615365744E616D653D2250726F76696465722200010C3800000020446174615365743D2250726F7669646572436F6E746163742220446174615365744E616D653D2250726F7669646572436F6E74616374220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="Provider" UserName="Provider" CloseDataSource="True" FieldAliases.Text="TYPE_MESSAGE=TYPE_MESSAGE&#13;&#10;PRIORITY=PRIORITY&#13;&#10;USER_NAME=USER_NAME&#13;&#10;CONTACT_R=CONTACT_R&#13;&#10;DATE_OUT=DATE_OUT&#13;&#10;DATE_CREATE=DATE_CREATE&#13;&#10;DESCRIPTION=DESCRIPTION&#13;&#10;TEXT_OUT=TEXT_OUT" ProviderName="GET_OUT_MESSAGE_DETAILS" FetchCount="-1" OpenMode="omExecute" PropData="05704C65667402380470546F700224"/>
    <TBisProvider Name="ProviderContact" UserName="ProviderContact" CloseDataSource="True" FieldAliases.Text="" FetchCount="-1" OpenMode="omOpen" PropData="05704C65667402380470546F700264"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page" Font.Charset="1" Font.Color="0" Font.Height="-7" Font.Name="Arial" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle" Height="64.25201" Left="0" Top="16" Width="699.21305">
      <TfrxMemoView Name="MemoTitle" Left="0" Top="0" Width="699.21305" Height="26.45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”РµС‚Р°Р»РёР·Р°С†РёСЏ РїРѕ Р·Р°РєР°Р·Сѓ"/>
      <TfrxMemoView Name="MemoTitle2" Left="0" Top="34.01577" Width="699.21305" Height="18.89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter" Height="18.89765" Left="0" Top="236" Width="699.21305">
      <TfrxMemoView Name="Memo49" Left="502.67749" Top="0" Width="196.53556" Height="18.89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Page#] РёР· [TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" Height="15.11812" Left="0" ParentFont="False" Top="176" Width="699.21305" OnBeforePrint="MasterDataOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="Provider" DataSetName="Provider" RowCount="0" Stretched="True">
      <TfrxMemoView Name="ProviderORDER_NUM_R" Left="0" Top="0" Width="41.57483" Height="15.11812" StretchMode="smMaxHeight" Color="16777215" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="1" Highlight.Font.Charset="1" Highlight.Font.Color="16777215" Highlight.Font.Height="-11" Highlight.Font.Name="Arial" Highlight.Font.Style="0" Highlight.Condition="&#60;line&#62; &#60;&#62; 1" ParentFont="False" Text="[IIF(&#60;Provider.&#34;TYPE_MESSAGE&#34;&#62; = 0, 'SMS', '')]"/>
      <TfrxMemoView Name="ProviderWHO_HISTORY" Left="555.59091" Top="0" Width="83.14966" Height="15.11812" StretchMode="smMaxHeight" Color="16777215" DataField="USER_NAME" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;USER_NAME&#34;]"/>
      <TfrxMemoView Name="ProviderWHO_PROCESS" Left="204.09462" Top="0" Width="60.47248" Height="15.11812" StretchMode="smMaxHeight" Color="16316664" DataField="DATE_OUT" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;DATE_OUT&#34;]"/>
      <TfrxMemoView Name="ProviderDESCRIPTION" Left="264.5671" Top="0" Width="188.9765" Height="15.11812" StretchMode="smMaxHeight" Color="16777215" DataField="TEXT_OUT" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;TEXT_OUT&#34;]"/>
      <TfrxMemoView Name="ProviderDATE_HISTORY" Left="105.82684" Top="0" Width="98.26778" Height="15.11812" StretchMode="smMaxHeight" Color="16777215" DataField="CONTACT_R" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;CONTACT_R&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="638.74057" Top="0" Width="60.47248" Height="15.11812" StretchMode="smMaxHeight" Color="16119285" DataField="DATE_CREATE" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="2" ParentFont="False" Text="[Provider.&#34;DATE_CREATE&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="453.5436" Top="0" Width="102.04731" Height="15.11812" StretchMode="smMaxHeight" Color="16250871" DataField="DESCRIPTION" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;DESCRIPTION&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="41.57483" Top="0" Width="64.25201" Height="15.11812" StretchMode="smMaxHeight" Color="16316664" DataField="PRIORITY" DataSet="Provider" DataSetName="Provider" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[Provider.&#34;PRIORITY&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header" Height="37.7953" Left="0" Top="100" Width="699.21305">
      <TfrxMemoView Name="Memo1" Left="555.59091" Top="0" Width="83.14966" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљС‚Рѕ СЃРѕР·РґР°Р»"/>
      <TfrxMemoView Name="Memo4" Left="105.82680094" Top="0" Width="98.26776291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕРЅС‚Р°РєС‚"/>
      <TfrxMemoView Name="Memo2" Left="204.09462" Top="0" Width="60.47246291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° РѕС‚РїСЂР°РІРєРё"/>
      <TfrxMemoView Name="Memo3" Left="41.57483" Top="0" Width="64.25199291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРёРѕСЂРёС‚РµС‚"/>
      <TfrxMemoView Name="Memo5" Left="453.5436" Top="0" Width="102.04729291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџСЂРёРјРµС‡Р°РЅРёРµ"/>
      <TfrxMemoView Name="Memo6" Left="264.5671" Top="0" Width="188.97648291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРµРєСЃС‚ СЃРѕРѕР±С‰РµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo10" Left="0" Top="0" Width="41.57483" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РўРёРї&#13;&#10;СЃРѕРѕР±С‰РµРЅРёСЏ"/>
      <TfrxMemoView Name="Memo7" Left="638.74057" Top="0" Width="60.47246291" Height="37.7953" Color="2685941" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° СЃРѕР·РґР°РЅРёСЏ"/>
    </TfrxHeader>
    <TfrxGroupHeader Name="GroupHeader1" Height="0" Left="0" Top="156" Width="699.21305" Condition="Provider.&#34;CONTACT_R&#34;"/>
    <TfrxGroupFooter Name="GroupFooter1" Height="3.77953" Left="0" Top="212" Width="699.21305" Stretched="True">
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="699.21305" Height="3.77953" DisplayFormat.DecimalSeparator="." Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text=""/>
    </TfrxGroupFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Детализация исходящих сообщений" Height="140" Left="271" Top="167" Width="337">
    <TBisEditDateControl Name="EditDateBegin" Left="72" Top="8" Width="93" Height="21" Color="-16777192" Text="  .  .    "/>
    <TBisEditDateControl Name="EditDateEnd" Left="192" Top="8" Width="93" Height="21" Color="-16777211" Text="  .  .    "/>
    <TBisLabelControl Name="LabelDateBegin" Left="16" Top="11" Width="50" Height="13" Alignment="taRightJustify" Caption="Период с:" Color="-16777201" FocusControl="EditDateBegin"/>
    <TfrxButtonControl Name="ButtonPeriod" Left="296" Top="8" Width="23" Height="21" Hint="Выбрать период" Caption="..." OnClick="ButtonPeriodOnClick"/>
    <TBisLabelControl Name="LabelDateEnd" Left="172" Top="12" Width="16" Height="13" Alignment="taRightJustify" Caption="по:" Color="-16777201" FocusControl="EditDateEnd"/>
    <TfrxButtonControl Name="ButtonOk" Left="164" Top="76" Width="75" Height="25" Caption="ОК" Default="True" OnClick="ButtonOkOnClick"/>
    <TfrxButtonControl Name="ButtonCancel" Left="244" Top="76" Width="75" Height="25" Cancel="True" Caption="Отмена" ModalResult="2" OnClick="ButtonCancelOnClick"/>
    <TfrxButtonControl Name="Button1" Left="16" Top="76" Width="95" Height="25" Caption="По умолчанию" OnClick="Button1OnClick"/>
    <TBisLabelControl Name="Label2" Left="16" Top="44" Width="47" Height="13" Alignment="taRightJustify" Caption="Контакт:" Color="-16777201" FocusControl="EditDateBegin" OnClick="Label1OnClick"/>
    <TfrxEditControl Name="EditContact" Left="72" Top="40" Width="121" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxButtonControl Name="ButtonContact" Left="204" Top="40" Width="23" Height="21" Hint="Выбрать контакт" Caption="..." OnClick="ButonContactOnClick"/>
  </TfrxDialogPage>
</TBisFastReport>
