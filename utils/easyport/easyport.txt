 
                                       easyport v 4.261 -  от 13.04.2007
          Эту памятку можно сохранить на диске, нажав правую кнопку мыши
 
   Внимание ! Если Вы хотите использовать программу для работы с двумя и более телефонами/модемами
  на ОДНОМ компьютере, создайте ОТДЕЛЬНЫЙ каталог для каждого телефона/модема и скопируйте 
  в них программу и её файлы.
  Не забудьте настроить каждую копию на СОМ-порт, к которому "прикреплён" каждый телефон !
 
  Для проверки УСТОЙЧИВОСТИ соединения телефона с компьютером (телефон-кабель-USB/ИК-порт-драйвера)
  выполните ПОСЛЕДНЮЮ операцию - "Тест-устойчивости-соединения-Cycle100".Число циклов можно увеличить
  Чтобы прервать выполнение (подождите 5-10 минут, не менее) нажмите на кнопку с перечёркнутым 
   восклицательным знаком на панели "Иные операции"
 
     ------------- И с т о р и я  о б н о в л е н и й ---------------------------------------------------
     NEW  v 4.261 - реализована внутренняя переменная %%i для включения в операции значения номера цикла
                 - добавлена операция с переменной цикла %%i
     NEW  v 4.251X - добавлена операция "Тест-устойчивости-соединения-Cycle100"
     NEW  v 4.25 - реализована возможность генерации и анализа команд телефона
     NEW  v 4.0  - программа может работать в паре с программой waitport для организации очереди к первой
                 - для СисАдминов (идея - Кухарец Роман Александрович)
     NEW  v 3.912- исправлена ошибка получения "одноцифрового" значения %%1 (спасибо ladas--@mv.ru)
     NEW  v 3.91 - изменён отсчёт времени (теперь - обратный) для команд ожидания
     NEW  v 3.90 - реализована внутренняя команда !start"чч:мм" для ожидания выполнения очередной команды
                   (по предложению Максима Когута)
     NEW  v 3.861- в кодировке UTF8 добавлено распознавание букв ё и Ё
     NEW  v 3.856- теперь можно пользоваться программой БЕЗ мыши (по предложению SPY u_next---@mail.ru)
     NEW  v 3.854- теперь разрешается запуск нескольких копий программы (из разных каталогов)"
     NEW  v 3.853- добавлена операция "Rus(UCS2)-Ждать СМС,записать номер,дату,время и имя посл. журнала"
     NEW  v 3.851- добавлена операция "Ждать СМС, записать в файл номер, дату, время и имя посл. журнала"
     NEW  v 3.850- реализована внутренняя переменная %%L для включения в операции имени файла журнала
     NEW  v 3.848- внесено изменение в обработку СМС, имеющих (начальные) пустые строки (для сателитов)"
     NEW  v 3.847- добавлена операция "Ждать СМС, послать СМС в ответ (в цикле)"
     NEW  v 3.834- модифицирована команда !bat - указание суффикса n - !batn подавляется вы 
     NEW  v 3.832- добавлена операция "Ждать СМС, записать в файл номер, дату и время"
     NEW  v 3.831- модифицирована команда !run - теперь в качестве разделителя параметров используется >
     NEW  v 3.83 - модифицирована внутренняя команда !waits - теперь можно получить данные, идущие следом
     NEW  v 3.82 - реализована внутренняя команда !! для включения в составные операции комментариев
     NEW  v 3.81 - реализована внутренняя команда !sound - для проигрывания звуковых файлов
     NEW  v 3.80 - реализована внутренняя команда !run - для запуска программы с параметрами
     NEW  v 3.79 - в кодировке UCS2 добавлено распознавание букв ё и Ё
     NEW  v 3.78 - реализована внутренняя команда !cycle для зацикливания всей или начальной части операции
     NEW  v 3.75 - повышена надёжность работы при внезапном отключении устройства(модема/телефона)
     NEW  v 3.72 - реализована внутренняя переменная %%pdul - для отправки SMS-сообщений с помощью !pduc
     NEW  v 3.70 - реализована внутренняя команда !pduc - для отправки SMS-сообщений в формате MGF=0
     NEW  v 3.65 - допускается комментарий в ПЕРВОЙ строке пакета - // <Комментарий> длиной 80 знаков 
     NEW  v 3.64 - исправлена ошибка, связанная с использованием знака ! в латинском SMS-сообщении
     NEW  v 3.63 - реализована возможность сложения и вычитания целого числа из результата вн. команды !gets
     NEW  v 3.62 - добавлены операции для получения информации о возможностях телефона и ОпСотСвязи
     NEW  v 3.61 - реализована внутренняя команда !pause
     NEW  v 3.60 - добавлена индикация входящего вызова  - звонка - индикатор RI (Ring)
     NEW  v 3.50 - повышена надёжность работы при неустойчивом подключении устройства(модема/телефона)
     NEW  если в вашем журнале хотя бы иногда появляются строки вида "! Вторая попытка подключения .."
     NEW  это означает, что подключение вашего телефона к компьютеру недостаточно устойчиво
     NEW  v 3.45 - уточнена работа с кодировкой UTF-8 (для телефонов SonyEricsson)
     NEW  v 3.40 - уточнена работа с кодировкой UCS2 (для телефонов SonyEricsson)
     NEW  v 3.38 - реализована возможность Magic Keys - можно писать программы управления телефоном
     NEW  v 3.35 - реализована возможность "хождения" по меню телефона с помощью команды +ckpd
     NEW  v 3.34 - добавлены операции отправки SMS, использующие !waits (для МТ Nokia,Sagem,LG и др.)
     NEW  v 3.23 - внесены изменения в ряд функций для обеспечения работы с различными моделями м.т
     NEW  v 3.20 - реализована внутренняя команда !wtime
     NEW  v 3.19 - реализована внутренняя команда !waits
     NEW  v 3.10 - можно выполнить пакет операций из файла в режиме AutoRun (требуется авторизация)
     NEW  v 2.97 - ещё большая независимость от производителей и моделей телефонов (за счёт !gets)
     NEW  v 2.96 - все операции переписаны с использованием внутренней команды !gets
     NEW  v 2.95 - можно выполнить любой пакет операций (команд) из внешнего текстового файла
     NEW  v 2.93 - можно использовать результаты команд в последующих командах, используя !gets
     NEW  v 2.91 - при закрытии программы автоматически сохраняется журнал (главное окно)
     NEW  v 2.90 - можно читать/добавлять/выгружать тел. книгу по-русски (в кодировке PCCP437)
     NEW  v 2.90 - распознаётся кодировка PCCP437,использующаяся в телефонах Nokia,Samsung,Alcatel,.
     NEW  v 2.87 - введено требование авторизации в режиме AutoRun на отправку новых SMS по-русски
                 - введено требование авторизации в режиме AutoRun на добавление в тел. книгу по-русски
     NEW  v 2.86 - отменено требование авторизации в режиме AutoRun для вн. операций - !pbs и !sms
     NEW  v 2.85 - можно создавать несколько библиотек операций (например, для разных телефонов)
     NEW  v 2.84 - можно задавать параметры (форму) выполнения в режиме AutoRun
     NEW  v 2.83 - можно получить трассу выполнения программы
     NEW  v 2.82 - можно выгрузить записи еженедельника по-русски (в кодировках UCS2 и UTF8
     NEW  v 2.81 - можно прочесть записи еженедельника по-русски (в кодировках UCS2 и UTF8)
     NEW  v 2.79 - можно отправить СМС по-русски (в UCS2 и UTF8) - записать/отправить/удалить
     NEW  v 2.78 - можно отправить СМС по-латински (записать/отправить/удалить)
     NEW  v 2.77 - можно напечатать прочитанный журнал, нажав правую кнопку мыши над текстом
     NEW  v 2.76 - можно выгрузить СМС-сообщения в режиме AutoRun
     NEW  v 2.75 - можно выгрузить СМС-сообщения (любого типа)
     NEW  v 2.70 - можно прочесть СМС-сообщения по-русски (распознаются кодировки UCS2 и UTF8)
     NEW  v 2.62 - можно загрузить выгруженную телефонную книгу в режиме AutoRun (тр. авторизация)
     NEW  v 2.61 - можно выгрузить телефонную книгу в режиме AutoRun
     NEW  v 2.60 - можно загрузить выгруженную телефонную книгу (в память SM и ME)
     NEW         - можно выгрузить телефонную книгу (из любого типа памяти)
     NEW         - можно просмотреть (удалить,скопировать,...) ранее сохранённые журналы
     NEW  v 2.50 - можно добавить запись в телефонную книгу, указав имя абонента ПО-РУССКИ
     NEW         - можно включать в состав операции "внутренние" команды
     NEW         - можно удалить запись из телефонной книги
     NEW         - можно прочесть тел. книгу по-русски (распознаются кодировки UCS2 и UTF8)
     NEW v 2.40  - в автоматическом режиме можно "спрятать" окно, а также запомнить
           и проанализировать результат, просто прочитав своей программой \AutoRun\LastRun.log
     NEW   - сохранение окна в автоматическом режиме выполняется в подкаталог "AutoRun"
     NEW   - сохранение окна выполняется в подкаталог "Logrec"
     NEW   - можно сохранять в файле и загружать из файла библиотеку операций
     NEW   - можно составлять операции из нескольких последовательных команд
     NEW   - можно сливать библиотеки операции разных версий и авторов
     NEW   - можно выполнять операции, задавая их в качестве параметра
     NEW   - можно выполнять команды, задавая их в качестве параметра
     NEW   - можно "возвращать" последнюю команду - клавишами Tab и ->
 
     -->> Как и зачем подключать телефон к компьютеру см. http://softeL.narod.ru/tocomp.html
 
1.  Прежде чем начать работать с устройством (модемом,телефоном,...), настройте параметры порта
2.  Выберите порт, к которому подключён модем (телефон)
3.  Укажите скорость 19200 или 38400 (выше - может "глючить")
4.  Остальные параметры в большинстве случаев менять не требуется
5.  Ввод возможен только, если порт открыт и за ним "видно" устройство
6.  Порт откроется, если всё в порядке
7.  Сначала попробуйте выполнить команды из "Операций", если что-то не получилось,
     сохраните содержимое окна на диске для последующего анализа
8.  Всякое нажатие - это  передача символа в порт (кроме "управляющих" нажатий -
     Shift, Delete, Insert, Esc, Ctrl, Alt, Home, End, стрелки, F1, F2 и т.д.)
9.  Не пользуйтесь мышью для позиционирования текста (например, для вставки внутрь строки)
10. Для исправления введённой строки (до нажатия Enter !) можно использовать
      клавишу BackSpace (<- в верхнем правом углу, под F12) - будет стирать последний символ
11. Для возврата последней отправленной в порт команды можно использовать
      клавишу Tab. Для возврата по одному символу (слева направо) - клавишу "->" стрелка вправо
12. По нажатию Enter будет выполняться посылка введённой строки в порт
13. Не торопитесь - устройство должно "проглотить" введённую строку - если
      во введённой строке нет команды, устройство может "молчать"
      - просто вводите очередную команду туда, где стоит курсор и жмите на Enter
 
14. Если устройство - мобильный телефон, для проверки выдайте следующие команды
     (знак ^ использован здесь для обозначения нажатия Enter - его вводить не надо):
 
ati3^          для отображения названия (марки) телефона
at+cgmi^       для отображения наименования производителя
at+cgmm^       для отображения названия модели
at+cgsn^       для отображения заводского номера аппарата
at+cgmr^       для отображения версии ПО ("прошивки")
at+csca?^      для отображения номера сервисного SMS-центра
at+cmgl=?^     для отображения списка типов SMS-сообщений
at+cmgl=ALL^   для отображения списка SMS-сообщений в телефоне на данный момент
at+cmgl="STO SENT"^   для отображения списка отправленных SMS-сообщений
at+cmgd=номер^   для удаления SMS-сообщения по номеру (см. список по команде at+cmgl=ALL)
at+cmss=номер^   для повторной отправки SMS-сообщения по номеру
(см. список по команде at+cmgl="STO SENT")
 --> Более полно команды описаны в документации, которую Вы найдёте на нашем сайте
      - http://softeL.narod.ru/mxterm.html
 
15. Если команды выполняются, подключение, скорее всего, получилось
 
16. Вы можете сами расширять список операций - см.  "Операции"/"@ИНЫЕ операции"
 --> Не все операции из списка "@ИНЫЕ операции" будут корректно работать
       для всех телефонов - пробуйте, уточняйте, заменяйте, добавляйте
 
17. Вы можете запускать программу в автоматическом режиме - из командной строки.
      Для этого при запуске нужно задать ДВА параметра: Cmd и правильную команду.
      Команду нужно сначала отладить в ручном режиме или через библиотеку - см. @ИНЫЕ
      Например, можно послать ранее отправленную СМС ! (Для многих телефонов подойдёт
      операция из @Иных, входящая в поставку. Для прочих телефонов - пробуйте,
      присылайте - попробуем вместе)
      Вызов будет выглядеть так: easyport.exe cmd at+cmss=<номер из списка отосланных>
 
18. Вы можете запускать программу в автоматическом режиме - из командной строки
      с ДВУМЯ параметрами: Oper и "наименование операции" ("её" команда может иметь "вставки"
      - номера и/или строки - последние должны быть заданы ПОСЛЕ первых двух в нужном количестве
      Например, можно послать ранее отправленную СМС - для многих телефонов подойдёт из @Иных
      Вызов: easyport.exe oper "Отправить ещё раз  СМС" <номер из списка отосланных>
    !! Очень важно указывать в ДВОЙНЫХ КАВЫЧКАХ все значения, имеющие внутри ПРОБЕЛЫ.
 
19. На этих возможностях (Cmd, Oper и "вставки") можно построить "систему оповещения":
      - подготовьте и отправьте нужные сообщения (не удаляйте их из телефона !);
      - зайдите в программу и опросите список отправленных СМС;
      - попробуйте отправить их ещё раз (из программы - см. @ИНЫЕ), используя их номера;
      - сохраните протокол (вам будут нужны операция/команда и номера);
      - подготовьте вызовы программы easyport cmd или oper с нужными операндами-номерами;
      - запускайте их из имеющейся у Вас оболочки/программы при соблюдении тех или иных условий
    ! Если в текущем каталоге будет лежать файл AutoRun.on, будет сохранён уникальный протокол
    ! Файл AutoRun.on содержит примеры запуска в автоматическом режиме - не удаляйте его !
    Если в файле easyport.ini Вы укажите LogFile=LastRun.log (или любое другое имя),
    то в автоматическом режиме в нём будут сохраняться результаты последнего запуска; 
    воспользуйтесь этим и прочтите-разберите содержимое этого файла из запускающей программы ..
    Можно задать минимизацию окна программы в автоматическом режиме - укажите Window=Min
20. Вы можете добавлять операции из новых версий к своим и наоборот
      Для этого воспользуйтесь кнопкой "Импорт" на форме "@ИНЫЕ операции",
      нажмите кнопку "Импорт" и укажите ini-файл из новой версии,
      программа автоматически добавит (но не заменит !) новые операции.
      Таким же образом можно сливать всякие другие копии ini-файлов (например, приятеля, ..)
21. Можно составлять операции из нескольких последовательных "правильных" команд,
      для этого нужно разделить их знаком "|" (см. пример из поставляемой библиотеки)
22. Операция может включать "внутренние" команды;
      для этого нужно написать !<"внутренняя "команда> (см. пример из библиотеки поставки)
      - !clr - очистить окно;
      - !log - сохранить окно;
      - !pbd - декодировать записи телефонной книги (на русский);
      - !pbs - выгрузить на диск записи телефонной книги;
      - !pbw - загрузить с диска (в диалоге) записи телефонной книги;
      - !pbwимяфайла - загрузить из файла записи телефонной книги;
         -  имяфайла - полное имя файла (путь) с выгрузкой записи телефонной книги;
         -  режим с именем файла удобно использовать в режиме AutoRun в сочетании с [
         -  (см. пример - @ИНЫЕ операции -> AutoRun-ЗАГРУЗИТЬ записи в телефон (ME))
         -  (см. пример в файле поставки AutoRun.on)
      - !smd - декодировать СМС-сообщения (на русский);
      - !sms - выгрузить на диск СМС-сообщения;
      - !dly - установить задержку в 300 мсек;
      - !mdd - декодировать записи еженедельника (на русский);
      - !mds - выгрузить на диск записи еженедельника;
      - !gets"строка" - ждать строку из телефона и получить данные, идущие следом;
      - !batимяфайла - выполнить из файла команды;
         -  имяфайла - полное имя файла (путь) к файлу;
         -  режим с именем файла удобно использовать в режиме AutoRun в сочетании с [
         -  (см. пример - @ИНЫЕ операции)
         -  (см. пример в файле поставки AutoRun.on)
      - !waits"строка" - ждать строку из телефона в течении !wtime"секунд" и получить данные, идущие следом;
      - !wtime"секунд" - задать время ожидания строки из телефона по команде !waits"строка" (умол=15);
      - !pause"секунд" - задать время паузы (умол=!wtime"секунд");
      - !pduc"номер SMS-центра","номер получателя","доставить не позднее чем через № часов","рус-лат текст");
        - внутренняя переменная %%pdul - используется вместе с внутренней командой !pduc и содержит
          порождаемую длину сообщения;
      - !cycle"число повторов всей или начальной части операции (пакета)";
         - допускается ОДНА !cycle на операцию (пакет) - все последующие будут игнорироваться;
         - !cycle без параметра задаёт бесконечный цикл от начала операции до команы !cycle;
      - !run"полный путь>параметр1>параметр2..." - для запуска программы с параметрами;
         - если программа сформирует пакет, можно его выполнить с помощью !bat;
         - чтобы дождаться окончания выполнения запущенной программы, поставьте !pause"секунды";
      - !sound"<полный путь к звуковому файлу>" - для проигрывания звуковых файлов;
         - форматы звуковых файлов: wav, midi;
      - !!<комментарий>;
      - !start"чч:мм" - задать время запуска идущей следом последоваательности команд;
     !!! Использование некоторых внутренних команд в режиме AutoRun требует авторизации -
     !!! см. readme.txt из поставки 
      
 P.S.     --------------------------------------------
    Работа с любой другой программой при открытом порте будет невозможна
    Закройте порт и программу
    Можете переходить к любой другой программе для работы с телефоном (модемом)
 
     Успехов !
 
 P.P.S.   ------------------------------------------
 1. Возможно, что к моменту, когда Вы начнёте использовать эту программу, на нашем сайте 
 будет выложена более новая версия - скачайте (cм. пункт главного меню "Новая версия" )
 2. Если у Вас появятся замечания (об ошибках) или предложения, пишите softeL1@narod.ru
 
