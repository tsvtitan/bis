unit PRTYPE;
{**************************************************************************}
{                                                                          }
{    This C DLL header file first (automatic) conversion generated by:     }
{    HeadConv 4.0 (c) 2000 by Bob Swart (aka Dr.Bob - www.drbob42.com)     }
{      Final Delphi-Jedi (Darth) command-line units edition                }
{                                                                          }
{    Generated Date: 02.05.2008                                            }
{    Generated Time: 15:09:00                                              }
{                                                                          }
{**************************************************************************}

interface
uses
{$IFDEF WIN32}
  Windows;
{$ELSE}
  Wintypes, WinProcs;
{$ENDIF}


{=> u:\source\imfotom.bpl\ps-rec+sdk+v1.1.0c\psrecsdk\inc\PRTYPE.H <=}

{$IFNDEF _PR_TYPE_H_}
{$DEFINE _PR_TYPE_H_}

{$IFDEF _MSC_VER}
{ # if 900 <= _MSC_VER }
{ # pragma message( "push, _PR_TYPE_H_PACK_, 1" ) }
{ # pragma pack( push, _PR_TYPE_H_PACK_, 1 ) }
{ # pragma warning( disable : 4250 4355 4244 4005) }
{ # endif /* 900 <= _MSC_VER*/ }
{$ELSE defined __WATCOMC__}
{ #pragma pack(__push,1); }
{$ENDIF}

{$IFDEF macintosh}
{$IFDEF PRAGMA_STRUCT_ALIGN}
{ #pragma options align=mac68k }
{$ENDIF}
{$ENDIF}

{+//*************************************************************************** }
{-**************************************************************************** }
{-* PowerShot RemoteCapture SDK : Data Type Definitions* }
{-**************************************************************************** }
{=*************************************************************************** }

{+// Basic Data Types*/ }
type
  prVoid = Integer;
type
  prUInt8 = Byte;
  pprUInt8=^prUInt8;
type
  prInt8 = Char;
type
  prChar = Char;
{$IFNDEF macintosh}
type
  prWChar = Word;
{$ENDIF}
type
  prUInt16 = Word;
type
  prInt16 = SmallInt;
type
  prUInt32 = LongInt;
  pprUInt32=^prUInt32;
type
  prInt32 = LongInt;
type
  prFloat32 = Single;
{$IFDEF macintosh}
type
  prUInt64 = UINT64;
{$ELSE}
type
  prUInt64 = Int64;
{$ENDIF}
type
  prResponse = PRUINT32;
  prCapi=prResponse;

type
  prBoolean = PRUINT16;
type
  prTime = PRUINT32;
type
  prEventID = PRUINT32;
type
  prContext = PRUINT32;

{$IFDEF macintosh}
type
  prFSSpec = FSSPEC;
{$ENDIF}

{+// Handles*/ }
{$IFDEF macintosh}
type
  prHWND = PRUINT32;
{$ELSE}
type
  prHWND = HWND;
{$ENDIF}
type
  prHandle = PRUINT32;
type
  prObjectHandle = PRUINT32;


const
  prANY = 1;

const
  prPTP_DATA_BUFFER_SIZE = (1024*1024);

{+// Definition of Opration Code*/ }
type
  prOperationCode = PRUINT16;
const
  prPTP_INITIATE_RELEASE_CONTROL = $9008;
const
  prPTP_TERMINATE_RELEASE_CONTROL = $9009;
const
  prPTP_RC_INITIATE_VIEW_FINDER = $900B;
const
  prPTP_RC_TERMINATE_VIEW_FINDER = $900C;
const
  prPTP_RC_RELEASE_DO_AE_AF_AWB = $900D;
const
  prPTP_RC_FOCUS_LOCK = $9014;
const
  prPTP_RC_FOCUS_UNLOCK = $9015;
const
  prPTP_RC_CAPTURE = $901A;
const
  prPTP_RC_GET_CHANGED_RELEASE_PARAMS_LIST = $9020;

{+// Progress Message*/ }
type
  prProgressMsg = PRINT32;
const
  prMSG_DATA_HEADER = $0001;
const
  prMSG_DATA = $0002;
const
  prMSG_TERMINATION = $0004;

{+// Progress Status*/ }
type
  prProgressSts = PRINT32;

{+// Event Codes*/ }
type
  prptpEventCode = PRUINT16;
const
  prPTP_DEVICE_PROP_CHANGED = $4006; {/* Deveice property has been changed.*/}
const
  prPTP_CAPTURE_COMPLETE = $400D; {/* Capture has finished.*/}
const
  prPTP_SHUTDOWN_CF_GATE_WAS_OPENED = $C001; {/* The Device has shut down due to the opening of the SD card cover.*/}
const
  prPTP_RESET_HW_ERROR = $C005; {/* The device has generated a hardware error.*/}
const
  prPTP_ABORT_PC_EVF = $C006; {/* The Viewfinder mode has been cancelled.*/}
const
  prPTP_ENABLE_PC_EVF = $C007; {/* The Viewfinder mode has been enablede.*/}
const
  prPTP_FULL_VIEW_RELEASED = $C008; {/* Transfer timing of main image data*/}
const
  prPTP_THUMBNAIL_RELEASED = $C009; {/* Transfer timing of thumbnail image data*/}
const
  prPTP_CHANGE_BATTERY_STATUS = $C00A; {/* The power condition of the camera has changed.*/}
const
  prPTP_PUSHED_RELEASE_SW = $C00B; {/* User has pressed the release swtich on camera.*/}
const
  prPTP_RC_PROP_CHANGED = $C00C; {/* A group of properties relating to release control have been changed.*/}
const
  prPTP_RC_ROTATION_ANGLE_CHANGED = $C00D; {/* The angle of rotation of the camera has been changed.*/}
const
  prPTP_RC_CHANGED_BY_CAM_UI = $C00E; {/* An operation control on the camera has been operated.*/}
const
  prCAL_SHUTDOWN = $D001; {/* Shutdown*/}

{+// Deveice Property Codes*/ }
type
  prptpDevicePropCode = PRUINT16;
const
  prPTP_DEV_PROP_BUZZER = $D001; {/* Set on/off the device buzzer*/}
const
  prPTP_DEV_PROP_BATTERY_KIND = $D002; {/* Type of the battery*/}
const
  prPTP_DEV_PROP_BATTERY_STATUS = $D003; {/* Buttery Status*/}
const
  prPTP_DEV_PROP_COMP_QUALITY = $D006; {/* Image quality*/}
const
  prPTP_DEV_PROP_FULLVIEW_FILE_FORMAT = $D007; {/* Image type*/}
const
  prPTP_DEV_PROP_IMAGE_SIZE = $D008; {/* Image size*/}
const
  prPTP_DEV_PROP_SELFTIMER = $D009; {/* Self-timer*/}
const
  prPTP_DEV_PROP_STROBE_SETTING = $D00A; {/* Strobe setting*/}
const
  prPTP_DEV_PROP_BEEP = $D00B; {/* Buzzer setting*/}
const
  prPTP_DEV_PROP_EXPOSURE_MODE = $D00C; {/* Exposure mode setting*/}
const
  prPTP_DEV_PROP_IMAGE_MODE = $D00D; {/* Image mode setting*/}
const
  prPTP_DEV_PROP_DRIVE_MODE = $D00E; {/* Drive mode*/}
const
  prPTP_DEV_PROP_EZOOM = $D00; {/* Electonic zoom setting*/}
const
  prPTP_DEV_PROP_ML_WEI_MODE = $D010; {/* Metering method*/}
const
  prPTP_DEV_PROP_AF_DISTANCE = $D011; {/* Search range in the AF mode*/}
const
  prPTP_DEV_PROP_FOCUS_POINT_SETTING = $D012; {/* Selection mode for focusing point*/}
const
  prPTP_DEV_PROP_WB_SETTING = $D013; {/* White balance setting*/}
const
  prPTP_DEV_PROP_SLOW_SHUTTER_SETTING = $D014; {/* Slow Shutter setting*/}
const
  prPTP_DEV_PROP_AF_MODE = $D015; {/* Auto focus mode setting*/}
const
  prPTP_DEV_PROP_IMAGE_STABILIZATION = $D016; {/* Image stabilization processing*/}
const
  prPTP_DEV_PROP_CONTRAST = $D017; {/* Contrast*/}
const
  prPTP_DEV_PROP_COLOR_GAIN = $D018; {/* Color Compensation*/}
const
  prPTP_DEV_PROP_SHARPNESS = $D019; {/* Sharpness*/}
const
  prPTP_DEV_PROP_SENSITIVITY = $D01A; {/* Sensitivity*/}
const
  prPTP_DEV_PROP_PARAMETER_SET = $D01B; {/* Development parameter setting*/}
const
  prPTP_DEV_PROP_ISO = $D01C; {/* ISO value*/}
const
  prPTP_DEV_PROP_AV = $D01D; {/* Av value*/}
const
  prPTP_DEV_PROP_TV = $D01E; {/* Tv value*/}
const
  prPTP_DEV_PROP_EXPOSURE_COMP = $D01; {/* Exposure compensation value*/}
const
  prPTP_DEV_PROP_FLASH_COMP = $D020; {/* Flash exposure compensation value*/}
const
  prPTP_DEV_PROP_AEB_EXPOSURE_COMP = $D021; {/* AEB exposure compensation value*/}
const
  prPTP_DEV_PROP_AV_OPEN = $D023; {/* Open aperture value*/}
const
  prPTP_DEV_PROP_AV_MAX = $D024; {/* maximum aperture value*/}
const
  prPTP_DEV_PROP_FOCAL_LENGTH = $D025; {/* Value corresponding to the current focal distance multiplied by FocalLengthDenominator*/}
const
  prPTP_DEV_PROP_FOCAL_LENGTH_TELE = $D026; {/* Value corresponding to the telescopic focal distance multiplied by FocalLengthDenominator*/}
const
  prPTP_DEV_PROP_FOCAL_LENGTH_WIDE = $D027; {/* Value corresponding to the wide-angle focus distance multiplied by FocalLengthDenominator*/}
const
  prPTP_DEV_PROP_FOCAL_LENGTH_DENOMI = $D028; {/* Focus information multiplier value*/}
const
  prPTP_DEV_PROP_CAPTURE_TRANSFER_MODE = $D029; {/* Image transfer mode to be applied at caputre*/}
const
  prPTP_DEV_PROP_ZOOM_POS = $D02A; {/* Current zoom position*/}

const
  prPTP_DEV_PROP_SUPPORTED_SIZE = $D02C; {/* Support size*/}
const
  prPTP_DEV_PROP_SUPPORTED_THUMB_SIZE = $D02D; {/* Thumbnail size supported by the device*/}
const
  prPTP_DEV_PROP_FIRMWARE_VERSION = $D031; {/* Version of the camera device firmware*/}
const
  prPTP_DEV_PROP_CAMERA_MODEL_NAME = $D032; {/* Camera model*/}
const
  prPTP_DEV_PROP_OWNER_NAME = $D033; {/* Owner name*/}
const
  prPTP_DEV_PROP_CAMERA_TIME = $D034; {/* Current time information in the device*/}
const
  prPTP_DEV_PROP_CAMERA_OUTPUT = $D036; {/* Destination of image signal output in the Viewfinder mode*/}
const
  prPTP_DEV_PROP_DISP_AV = $D037; {/* How to display the Av value*/}
const
  prPTP_DEV_PROP_AV_OPEN_APEX = $D038; {/* Open aperture value*/}
const
  prPTP_DEV_PROP_EZOOM_SIZE = $D039; {/* Horizontal size of image to be cut out from CCD image using electronic zoom*/}
const
  prPTP_DEV_PROP_ML_SPOT_POS = $D03A; {/* Spot metering positon*/}
const
  prPTP_DEV_PROP_DISP_AV_MAX = $D03B; {/* How to display the maximin Av value*/}
const
  prPTP_DEV_PROP_AV_MAX_APEX = $D03C; {/* minimum aperture value*/}
const
  prPTP_DEV_PROP_EZOOM_START_POS = $D03D; {/* Zoom position at which the electornic zoom range starts*/}
const
  prPTP_DEV_PROP_FOCAL_LENGTH_OF_TELE = $D03E; {/* Focal distance at the optical telescopic end*/}
const
  prPTP_DEV_PROP_EZOOM_SIZE_OF_TELE = $D03; {/* Horizontal size of image to be cut out from CCD image at the telescopic end of the electronic zoom range*/}
const
  prPTP_DEV_PROP_PHOTO_EFFECT = $D040; {/* Photo effect*/}
const
  prPTP_DEV_PROP_AF_LIGHT = $D041; {/* ON/OFF of AF assist light*/}
const
  prPTP_DEV_PROP_FLASH_QUANTITY = $D042; {/* Number of flash levels that can be set in the manual mode*/}
const
  prPTP_DEV_PROP_ROTATION_ANGLE = $D043; {/* Angle of rotation detected by the gravity sensor*/}
const
  prPTP_DEV_PROP_ROTATION_SENCE = $D044; {/* Whether the gravity sensor is enable or disable*/}
const
  prPTP_DEV_PROP_IMEGE_FILE_SIZE = $D048; {/* Image file size supported be the camera*/}
const
  prPTP_DEV_PROP_CAMERA_MODEL_ID = $D049; {/* Camera model ID*/}

{+// AE,AF,AWB Reset flag*/ }
type
  prptpAeAfAwbResetFlag = PRUINT32;
const
  prptpAEAFAWB_RESET_AE = $00000001; {/* AE Reset*/}
const
  prptpAEAFAWB_RESET_AF = $00000002; {/* AF Reset*/}
const
  prptpAEAFAWB_RESET_AWB = $00000004; {/* AWB Reset*/}

{+// Port type*/ }
type
  prPorttype = PRUINT16;
const
  prPORTTYPE_WIA = $0001; {/* WIA*/}
const
  prPORTTYPE_STI = $0002; {/* STI*/}

const
  prGENERATION_CAMERA_MASK = $ff00;
{const
  prSUB_GENERATION_CAMERA(gen) = ((gen&prGENERATION_CAMERA_MASK)>>8);}

{+// Object type*/ }
type
  prptpObjectFormatCode = PRUINT16;
const
  prPTP_EXIF_JPEG = $3801; {/* EXIF JPEG*/}
const
  prPTP_CRW = $B101; {/* RAW*/}




{+//*************************************************************************** }
{-**************************************************************************** }
{-* PowerShot RemoteCapture SDK : Structers* }
{-**************************************************************************** }
{=*************************************************************************** }

type

(*typedef struct{
	prWChar ModuleName[512];				/* Module name (512 characters)	*/
	prWChar Version[32];					/* Version (32 characters) */
}prVerInfo;*)

  prVerInfo=record
    ModuleName: array[0..511] of prWChar;				// Module name (512 characters)	*/
   	Version: array[0..31] of  prWChar;					// Version (32 characters) */
  end;

(*typedef struct{
	prUInt32  Entry;						/* Number of modules included in this structure */
	prVerInfo VerInfo[prANY]; 				/* Array of file version number information of PS-ReC SDK modules */
}prDllsVerInfo;*)

  prDllsVerInfo=record
    Entry: prUInt32;
    VerInfo: array[0..prANY-1] of prVerInfo;
  end;
  pprDllsVerInfo=^prDllsVerInfo;

(*typedef struct{
	prWChar           DeviceInternalName[512];	/* Internal devicve name (512 characters) */
	prWChar    	      ModelName[32];          	/* Camera model name (32 characters) */
	prUInt16	      Generation;				/* Camera generation number */
	prUInt32		  Reserved1;				/* Reserved */
	prUInt32	      ModelID;					/* Camera model ID */
	prUInt16		  Reserved2;				/* Reserved */
	prPorttype	      PortType;					/* Port type 0x01：WIA / 0x02：STI */
	prUInt32		  Reserved3;				/* Reserved */
}prDeviceInfoTable;*)

  prDeviceInfoTable=record
    DeviceInternalName: array[0..511] of prWChar;
    ModelName: array[0..31] of prWChar;
    Generation: prUInt16;
    Reserved1: prUInt32;
    ModelID: prUInt32;
    Reserved2: prUInt16;
    PortType: prPorttype;
    Reserved3: prUInt32;
  end;
  pprDeviceInfoTable=^prDeviceInfoTable;

(*typedef struct{
	prUInt32	NumList;					/* Number of camera device information included in this structure */
	prDeviceInfoTable DeviceInfo[prANY];	/* Camera device information */
}prDeviceList;*)

  prDeviceList=record
    NumList: prUInt32;
    DeviceInfo: array[0..prANY-1] of prDeviceInfoTable;
  end;

(*typedef struct{
	prProgressMsg lMessage;					/* Message */
	prProgressSts lStatus;					/* Status */
	prUInt32	  lPercentComplete;			/* The uint of this parameter is percent */
	prUInt32	  lOffset;					/* Offset */
	prUInt32	  lLength;					/* Size */
	prUInt32	  lReserved;				/* Reserved */
	prUInt32	  lResLength;				/* Reserved */
	prUInt8 *	  pbData;					/* Pointer to the buffer in which the transferred data is stored. */
}prProgress;*)

  prProgress=record
    lMessage: prProgressMsg;
    lStatus: prProgressSts;
    lPercentComplete: prUInt32;
    lOffset: prUInt32;
    lLength: prUInt32;
    lReserved: prUInt32;
    lResLength: prUInt32;
    pbData: pprUInt8;
  end;



{{{ typedef struct{ }
{= Module name (512 characters) }
{= Version (32 characters) }

{{{ typedef struct{ }
{= Number of modules included in this structure }
{= Array of file version number information of PS-ReC SDK modules }

{{{ typedef struct{ }
{= Internal devicve name (512 characters) }
{= Camera model name (32 characters) }
{= Camera generation number }
{= Reserved }
{= Camera model ID }
{= Reserved }
{= Port type 0x01：WIA / 0x02：STI }
{= Reserved }

{{{ typedef struct{ }
{= Number of camera device information included in this structure }
{= Camera device information }

{{{ typedef struct{ }
{= Message }
{= Status }
{= The uint of this parameter is percent }
{= Offset }
{= Size }
{= Reserved }
{= Reserved }
{= Pointer to the buffer in which the transferred data is stored. }

{$IFDEF macintosh}
{$IFDEF PRAGMA_STRUCT_ALIGN}
{ #pragma options align=reset }
{$ENDIF}
{$ENDIF}


{$IFDEF _MSC_VER}
{ # if 900 <= _MSC_VER }
{ # pragma message( "pop, _PR_TYPE_H_PACK_" ) }
{ # pragma warning( default : 4250 4355 4244 4005) }
{ # pragma pack( pop, _PR_TYPE_H_PACK_ ) }
{ # endif /* 900 <= _MSC_VER*/ }
{$ELSE defined __WATCOMC__}
{ #pragma pack(__pop); }
{$ENDIF}


{$ENDIF}



var
  DLLLoaded: Boolean { is DLL (dynamically) loaded already? }
    {$IFDEF WIN32} = False; {$ENDIF}

implementation

var
  SaveExit: pointer;
  DLLHandle: THandle;
{$IFNDEF MSDOS}
  ErrorMode: Integer;
{$ENDIF}

  procedure NewExit; far;
  begin
    ExitProc := SaveExit;
    FreeLibrary(DLLHandle)
  end {NewExit};

procedure LoadDLL;
begin
  if DLLLoaded then Exit;
{$IFNDEF MSDOS}
  ErrorMode := SetErrorMode($8000{SEM_NoOpenFileErrorBox});
{$ENDIF}
  DLLHandle := LoadLibrary('PRTYPE.DLL');
  if DLLHandle >= 32 then
  begin
    DLLLoaded := True;
    SaveExit := ExitProc;
    ExitProc := @NewExit;
  end
  else
  begin
    DLLLoaded := False;
    { Error: PRTYPE.DLL could not be loaded !! }
  end;
{$IFNDEF MSDOS}
  SetErrorMode(ErrorMode)
{$ENDIF}
end {LoadDLL};

begin
//  LoadDLL;
end.
