unit BisNames;

interface

uses Classes, Contnrs;

type

  TBisName=class(TObject)
  private
    FName: String;
  public
    constructor Create; virtual;

    property Name: String read FName;
  end;

  TBisNameClass=class of TBisName;

  TBisNames=class(TObjectList)
  private
    function GetItem(Index: Integer): TBisName;
  protected
    function GetNameClass: TBisNameClass; virtual;
  public
    function Find(Name: String): TBisName;
    function Add(Name: String): TBisName;

    property Items[Index: Integer]: TBisName read GetItem;
  end;

implementation

uses SysUtils;

{ TBisName }

constructor TBisName.Create;
begin
  inherited Create; 
end;

{ TBisNames }

function TBisNames.GetNameClass: TBisNameClass;
begin
  Result:=TBisName;
end;

function TBisNames.GetItem(Index: Integer): TBisName;
begin
  Result:=TBisName(inherited Items[Index]);
end;

function TBisNames.Find(Name: String): TBisName;
var
  i: Integer;
  Item: TBisName;
begin
  Result:=nil;
  for i:=0 to Count-1 do begin
    Item:=Items[i];
    if AnsiSameText(Item.Name,Name) then begin
      Result:=Item;
      Break;
    end;
  end;
end;

function TBisNames.Add(Name: String): TBisName;
var
  AClass: TBisNameClass;
begin
  Result:=nil;
  if not Assigned(Find(Name)) then begin
    AClass:=GetNameClass;
    if Assigned(AClass) then begin
      Result:=AClass.Create;
      Result.FName:=Name;
      inherited Add(Result);
    end;
  end;
end;

end.
