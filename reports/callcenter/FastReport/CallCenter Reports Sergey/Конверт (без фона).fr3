<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39549,530979537" ReportOptions.Description.Text="" ReportOptions.LastChange="39622,7450611227" ScriptLanguage="PascalScript" ScriptText.Text="Procedure FillAddressComboBox;&#13;&#10;Begin&#13;&#10;  AddressComboBox.Items.Clear;&#13;&#10;  AddressComboBox.Items.Add('Адрес прописки');&#13;&#10;  AddressComboBox.Items.Add('Адрес фактический');&#13;&#10;  AddressComboBox.Items.Add('Адрес дополнительный');&#13;&#10;  AddressComboBox.Items.Add('Адрес работы');&#13;&#10;  OKButton.Enabled:=False;                                                    &#13;&#10;End;&#13;&#10;  &#13;&#10;procedure AddressComboBoxOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  OKButton.Enabled:=True;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DealsButtonOnClick(Sender: TfrxComponent);&#13;&#10;var DebId, DealNum: String;&#13;&#10;  S: String;&#13;&#10;  F: TBisFilterGroup;&#13;&#10;  P: Integer;                           &#13;&#10;begin&#13;&#10;  if (DealsEdit.Text&#60;&#62;'') Then Begin&#13;&#10;    S:=DealsEdit.Text;                                 &#13;&#10;    Delete(S,1,16);&#13;&#10;    P:=Pos(' ',S);          &#13;&#10;    S:=Copy(S,1,P-2);                            &#13;&#10;  End Else&#13;&#10;    S:='';                           &#13;&#10;  if DataSelectInto('Кредитные дела',DealsProvider,'DEAL_NUM',S) then begin&#13;&#10;    DebId:=DealsProvider.FieldByName('DEBTOR_ID').AsString;&#13;&#10;    DealNum:=DealsProvider.FieldByName('DEAL_NUM').AsString;&#13;&#10;    DebtorsProvider.Close;                      &#13;&#10;    DebtorsProvider.FilterGroups.Clear;                      &#13;&#10;    F:=DebtorsProvider.FilterGroups.Add;        &#13;&#10;    F.Filters.Add('DEBTOR_ID',fcEqual,DebId);&#13;&#10;    DebtorsProvider.Open;&#13;&#10;    DealsEdit.Text:='Кредитное дело №'+DealNum+'. '+&#13;&#10;                    DebtorsProvider.FieldByName('SURNAME_IP').AsString+' '+&#13;&#10;                    DebtorsProvider.FieldByName('NAME_IP').AsString+' '+&#13;&#10;                    DebtorsProvider.FieldByName('PATRONYMIC_IP').AsString;  &#13;&#10;    FillAddressComboBox;                                                                    &#13;&#10;  end;  &#13;&#10;end;&#13;&#10;&#13;&#10;Var&#13;&#10;  DialogVisible: Variant;&#13;&#10;  S: Variant;&#13;&#10;  Str: TStringList;&#13;&#10;  DealFilterGroup, F: TBisFilterGroup;&#13;&#10;  I: Integer;&#13;&#10;  DealId: String;                                   &#13;&#10;&#13;&#10;Begin                                                          &#13;&#10;  DialogVisible:=Report.Calc('DIALOG_VISIBLE');&#13;&#10;&#13;&#10;  If (DialogVisible=0) Then Begin&#13;&#10;    DealsEdit.Enabled:=False;&#13;&#10;    DealsButton.Enabled:=False;&#13;&#10;    DealsLabel.Enabled:=False;&#13;&#10;    FillAddressComboBox;&#13;&#10;&#13;&#10;    try&#13;&#10;      Str:=TStringList.Create;          &#13;&#10;                &#13;&#10;      S:=Report.Calc('DEAL_IDS');                                                     &#13;&#10;&#13;&#10;      GetStringsByString(S,';',Str);&#13;&#10;      DealsProvider.FilterGroups.Clear;&#13;&#10;      DealFilterGroup:=DealsProvider.FilterGroups.Add;            &#13;&#10;          &#13;&#10;      for I:=0 to Str.Count-1 do begin&#13;&#10;        DealId:=Str.Strings[I];                                    &#13;&#10;        DealFilterGroup.Filters.Add('DEAL_ID',fcEqual,DealId).Operator:=foOr;                                                         &#13;&#10;      end;&#13;&#10;           &#13;&#10;       DebtorsProvider.FilterGroups.Clear;                      &#13;&#10;       F:=DebtorsProvider.FilterGroups.Add;                           &#13;&#10;       DealsProvider.Open;                         &#13;&#10;       DealsProvider.First;                                                 &#13;&#10;       for I:=0 to Str.Count-1 do begin                                  &#13;&#10;         F.Filters.Add('DEBTOR_ID',fcEqual,DealsProvider.FieldByName('DEBTOR_ID').AsString).Operator:=foOr;                                                                       &#13;&#10;         DealsProvider.Next;                                                 &#13;&#10;       end;                   &#13;&#10;       DebtorsProvider.Open;                                      &#13;&#10;          &#13;&#10;    finally&#13;&#10;      Str.Free;&#13;&#10;    End;&#13;&#10;      &#13;&#10;  End;            &#13;&#10;End.&#13;&#10;    " PropData="08446174617365747301010C3400000020446174615365743D224465616C7350726F76696465722220446174615365744E616D653D224465616C7350726F76696465722200010C3800000020446174615365743D22446562746F727350726F76696465722220446174615365744E616D653D22446562746F727350726F7669646572220000095661726961626C657301010C12000000204E616D653D2220CFE0F0E0ECE5F2F0FB2200010C16000000204E616D653D224449414C4F475F56495349424C452200010C10000000204E616D653D224445414C5F494453220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="DealsProvider" UserName="DealsProvider" CloseDataSource="True" FieldAliases.Text="" ProviderName="DEALS" FetchCount="-1" PropData="05704C65667402240470546F700220"/>
    <TBisProvider Name="DebtorsProvider" UserName="DebtorsProvider" CloseDataSource="True" FieldAliases.Text="" ProviderName="S_DEBTORS_DP" FetchCount="-1" PropData="05704C65667402280470546F700274"/>
  </TfrxDataPage>
  <TfrxReportPage Name="CoverPage" Orientation="poLandscape" PaperWidth="186" PaperHeight="105,7" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxGroupHeader Name="GroupHeader1" Height="0" Left="0" Top="18,89765" Width="702,99258" Condition="DebtorsProvider.&#34;DEBTOR_ID&#34;" StartNewPage="True"/>
    <TfrxMasterData Name="MasterData1" Height="357" Left="0" Top="41,57483" Width="702,99258" ColumnWidth="0" ColumnGap="0" DataSet="DebtorsProvider" DataSetName="DebtorsProvider" RowCount="0">
      <TfrxMemoView Name="Index1Memo" Left="54,91342" Top="276,12616" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,1,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,1,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,1,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,1,1))))]"/>
      <TfrxMemoView Name="Index2Memo" Left="84,14966" Top="276,28346457" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,2,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,2,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,2,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,2,1))))]"/>
      <TfrxMemoView Name="Index3Memo" Left="114,3859" Top="276,28346457" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,3,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,3,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,3,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,3,1))))]"/>
      <TfrxMemoView Name="Index4Memo" Left="143,62214" Top="276,28346457" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,4,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,4,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,4,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,4,1))))]"/>
      <TfrxMemoView Name="Index5Memo" Left="173,85838" Top="276,28346457" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,5,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,5,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,5,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,5,1))))]"/>
      <TfrxMemoView Name="Index6Memo" Left="204,09462" Top="276,28346457" Width="26,45671" Height="41,57480071" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-40" Font.Name="CourtierC" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,6,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,6,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,6,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,6,1))))]"/>
      <TfrxMemoView Name="Memo6" Left="57,47248" Top="6,77953" Width="226,7718" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РћРћРћ РљРђ &#34;РЎРѕР±СЂР°РЅРёРµ РЎРёР±РёСЂСЊ РљРѕР»Р»РµРєС€РЅ&#34;"/>
      <TfrxMemoView Name="Memo7" Left="113,3859" Top="29,23624" Width="109,60637" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РґРѕ РІРѕСЃС‚СЂРµР±РѕРІР°РЅРёСЏ"/>
      <TfrxMemoView Name="Memo9" Left="203,87415" Top="73,5906" Width="45,35436" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="660118"/>
      <TfrxMemoView Name="DebtorFIOMemo" Left="374,17347" Top="144,62214" Width="283,46475" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[DebtorsProvider.&#34;SURNAME_DP&#34;] [DebtorsProvider.&#34;NAME_DP&#34;] [DebtorsProvider.&#34;PATRONYMIC_DP&#34;]"/>
      <TfrxMemoView Name="AddressMemo" Left="374,17347" Top="187,19697" Width="283,46475" Height="79,37013" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,&#60;DebtorsProvider.&#34;ADDRESS_RESIDENCE&#34;&#62;,IIF(AddressComboBox.ItemIndex=1,&#60;DebtorsProvider.&#34;ADDRESS_ACTUAL&#34;&#62;,IIF(AddressComboBox.ItemIndex=2,&#60;DebtorsProvider.&#34;ADDRESS_ADDITIONAL&#34;&#62;,&#60;DebtorsProvider.&#34;ADDRESS_WORK&#34;&#62;)))]"/>
      <TfrxMemoView Name="IndexMemo" Left="379,17347" Top="277,90569" Width="45,35436" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,IIF(AddressComboBox.ItemIndex=1,&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,IIF(AddressComboBox.ItemIndex=2,&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;)))]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="DebtorsDialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Отчет &#34;Конверт (без фона)&#34;" Height="182" Left="265" Top="150" Width="531">
    <TfrxGroupBoxControl Name="DebtorsGroupBox" Left="4" Top="4" Width="513" Height="113" Caption="Выбор кредитного дела и адреса" Color="-16777201">
      <TfrxButtonControl Name="DealsButton" Left="476" Top="33" Width="21" Height="21" Caption="..." OnClick="DealsButtonOnClick"/>
      <TBisEditControl Name="DealsEdit" Left="108" Top="33" Width="361" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
      <TBisLabelControl Name="DealsLabel" Left="16" Top="36" Width="84" Height="13" Caption="Кредитное дело" Color="-16777201" FocusControl="DealsEdit"/>
      <TBisComboBoxControl Name="AddressComboBox" Left="108" Top="64" Width="389" Height="21" Color="-16777211" Items.Text="" Style="csDropDownList" ItemIndex="-1" OnChange="AddressComboBoxOnChange"/>
      <TBisLabelControl Name="AddressLabel" Left="67" Top="67" Width="31" Height="13" Caption="Адрес" Color="-16777201" FocusControl="AddressComboBox"/>
    </TfrxGroupBoxControl>
    <TfrxButtonControl Name="CancelButton" Left="442" Top="124" Width="75" Height="25" Caption="Отмена" ModalResult="2" OnClick="CancelButtonOnClick"/>
    <TfrxButtonControl Name="OKButton" Left="360" Top="124" Width="75" Height="25" Enabled="False" Caption="OK" ModalResult="1" OnClick="OKButtonOnClick"/>
  </TfrxDialogPage>
</TBisFastReport>
