<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39645,6351349074" ReportOptions.Description.Text="" ReportOptions.LastChange="39655,7731573611" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  FAgreementId: Variant;                                &#13;&#10;  FPeriodType: TBisPeriodType;&#13;&#10;                             &#13;&#10;procedure ButtonOkOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if Trim(EditAgreement.Text)='' then begin&#13;&#10;    ShowError('Íåîáõîäèìî ââåñòè çíà÷åíèå â ïîëå ('+LabelAgreement.Caption+').');                              &#13;&#10;    EditAgreement.SetFocus;&#13;&#10;  end else begin&#13;&#10;    Provider.Params.Clear;&#13;&#10;    Provider.Params.Add('AGREEMENT_ID',ptInput).Value:=FAgreementId;&#13;&#10;    Provider.Params.Add('DATE_BEGIN',ptInput).Value:=EditDateBegin.Date;&#13;&#10;    Provider.Params.Add('DATE_END',ptInput).Value:=EditDateEnd.Date;&#13;&#10;  &#13;&#10;    DialogPage.ModalResult:=mrOk;&#13;&#10;  end;                        &#13;&#10;end;&#13;&#10;&#13;&#10;procedure SetCurrencyName(VariantId: Variant);&#13;&#10;var&#13;&#10;  P: TBisProvider;&#13;&#10;begin&#13;&#10;  P:=TBisProvider.Create(nil);&#13;&#10;  try&#13;&#10;    P.ProviderName:='S_VARIANTS';&#13;&#10;    P.FieldNames.Add('CURRENCY_NAME');                                                            &#13;&#10;    P.FilterGroups.Add.Filters.Add('VARIANT_ID',fcEqual,VariantId);&#13;&#10;    P.Open;&#13;&#10;    if P.Active and not P.IsEmpty then begin&#13;&#10;      Report.Variables['CURRENCY_NAME']:=QuotedStr(P.FieldByName('CURRENCY_NAME').AsString);&#13;&#10;    end;                &#13;&#10;  finally&#13;&#10;    P.Free;                             &#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButtonAgreementOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  P: TBisProvider;&#13;&#10;  AgreementNum: String;&#13;&#10;  AgreementDate: String;                   &#13;&#10;begin&#13;&#10;  P:=TBisProvider.Create(nil);&#13;&#10;  try          &#13;&#10;    if DataSelectInto('Äîãîâîðû',P,'AGREEMENT_ID',FAgreementId) then begin&#13;&#10;      if P.Active and not P.IsEmpty then begin&#13;&#10;        FAgreementId:=P.FieldByName('AGREEMENT_ID').AsString;&#13;&#10;        AgreementNum:=P.FieldByName('NUM').AsString;&#13;&#10;        AgreementDate:=P.FieldByName('DATE_BEGIN').AsString;                                              &#13;&#10;        EditAgreement.Text:=AgreementNum+' îò '+AgreementDate+' '+P.FieldByName('FIRM_SMALL_NAME').AsString;&#13;&#10;        &#13;&#10;        Report.Variables['AGREEMENT_NUM']:=QuotedStr(AgreementNum);&#13;&#10;        Report.Variables['AGREEMENT_DATE']:=QuotedStr(AgreementDate);&#13;&#10;        SetCurrencyName(P.FieldByName('VARIANT_ID').Value);            &#13;&#10;      end;                &#13;&#10;    end;&#13;&#10;  finally&#13;&#10;    P.Free;                                   &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;        &#13;&#10;procedure ButtonPeriodOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D1,D2: TDateTime;                                            &#13;&#10;begin&#13;&#10;  D1:=EditDateBegin.Date;&#13;&#10;  D2:=EditDateEnd.Date;                              &#13;&#10;  if PeriodSelect(FPeriodType,D1,D2) then begin&#13;&#10;    EditDateBegin.Date:=D1;&#13;&#10;    EditDateEnd.Date:=D2;                      &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  FAgreementId:=Null;                    &#13;&#10;  FPeriodType:=ptMonth;&#13;&#10;  EditAgreement.Color:=ColorControlReadOnly;&#13;&#10;  EditDateBegin.Color:=clWindow;                                      &#13;&#10;end." PropData="08446174617365747301010C2A00000020446174615365743D2250726F76696465722220446174615365744E616D653D2250726F7669646572220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C15000000204E616D653D2241475245454D454E545F4E554D2200010C16000000204E616D653D2241475245454D454E545F444154452200010C15000000204E616D653D2243555252454E43595F4E414D45220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="Provider" UserName="Provider" CloseDataSource="True" FieldAliases.Text="DEBTOR_NUM=DEBTOR_NUM&#13;&#10;SURNAME=SURNAME&#13;&#10;NAME=NAME&#13;&#10;PATRONYMIC=PATRONYMIC&#13;&#10;ADDRESS_RESIDENCE=ADDRESS_RESIDENCE&#13;&#10;INITIAL_DEBT=INITIAL_DEBT&#13;&#10;AMOUNT=AMOUNT&#13;&#10;DEBT=DEBT" ProviderName="DEBTOR_PAYMENTS" FetchCount="-1" OpenMode="omExecute" PropData="05704C65667402680470546F700230"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="PageOnBeforePrint">
    <TfrxReportTitle Name="ReportTitle" Height="75,5906" Left="0" Top="18,89765" Width="1028,03216">
      <TfrxMemoView Name="Memo4" Left="253,22851" Top="0" Width="491,3389" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ»Ð°Ñ‚ÐµÐ¶Ð¸ Ð´Ð¾Ð»Ð¶Ð½Ð¸ÐºÐ¾Ð²"/>
      <TfrxMemoView Name="Memo2" Left="253,22851" Top="49,13389" Width="491,3389" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [EditDateBegin.Text] Ð¿Ð¾ [EditDateEnd.Text]"/>
      <TfrxMemoView Name="Memo12" Left="253,22851" Top="26,45671" Width="491,3389" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="Ð¿Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñƒ Ð¿Ð¾Ñ€ÑƒÑ‡ÐµÐ½Ð¸Ñ â„– [AGREEMENT_NUM] Ð¾Ñ‚ [AGREEMENT_DATE]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter" Height="18,89765" Left="0" Top="336,37817" Width="1028,03216">
      <TfrxMemoView Name="Memo49" Left="831,4966" Top="0" Width="196,53556" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Page#] Ð¸Ð· [TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData" Height="18,89765" Left="0" Top="215,43321" Width="1028,03216" ColumnWidth="0" ColumnGap="0" DataSet="Provider" DataSetName="Provider" RowCount="0">
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="34,01577" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Line]"/>
      <TfrxMemoView Name="Memo5" Left="34,01577" Top="0" Width="98,26778" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;DEBTOR_NUM&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="132,28355" Top="0" Width="272,12616" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;SURNAME&#34;] [Provider.&#34;NAME&#34;] [Provider.&#34;PATRONYMIC&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="404,40971" Top="0" Width="340,1577" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;ADDRESS_RESIDENCE&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="744,56741" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;INITIAL_DEBT&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="839,05566" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;AMOUNT&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="933,54391" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;DEBT&#34;]"/>
    </TfrxMasterData>
    <TfrxFooter Name="Footer" Height="18,89765" Left="0" Top="257,00804" Width="1028,03216">
      <TfrxMemoView Name="Memo14" Left="650,07916" Top="0" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ñ‚Ð¾Ð³Ð¾:"/>
      <TfrxMemoView Name="Memo16" Left="744,56741" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Provider.&#34;INITIAL_DEBT&#34;&#62;,MasterData)]"/>
      <TfrxMemoView Name="Memo17" Left="839,05566" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Provider.&#34;AMOUNT&#34;&#62;,MasterData)]"/>
      <TfrxMemoView Name="Memo18" Left="933,54391" Top="0" Width="94,48825" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2n" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="4" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Provider.&#34;DEBT&#34;&#62;,MasterData)]"/>
    </TfrxFooter>
    <TfrxHeader Name="Header" Height="37,7953" Left="0" Top="154,96073" Width="1028,03216" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="34,01577" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð¿/Ð¿"/>
      <TfrxMemoView Name="MemoAge30" Left="34,01577" Top="0" Width="98,26778" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– ÐºÑ€ÐµÐ´. Ð´ÐµÐ»Ð°"/>
      <TfrxMemoView Name="MemoAge3145" Left="132,28355" Top="0" Width="272,12616" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¤Ð˜Ðž Ð´Ð¾Ð»Ð¶Ð½Ð¸ÐºÐ°"/>
      <TfrxMemoView Name="MemoAge4660" Left="404,40971" Top="0" Width="340,1577" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ´Ñ€ÐµÑ Ð´Ð¾Ð»Ð¶Ð½Ð¸ÐºÐ°"/>
      <TfrxMemoView Name="Memo15" Left="744,56741" Top="0" Width="94,48825" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¡ÑƒÐ¼Ð¼Ð° Ð´Ð¾Ð»Ð³Ð° ([CURRENCY_NAME])"/>
      <TfrxMemoView Name="Memo8" Left="839,05566" Top="0" Width="94,48825" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ¾ÑÑ‚ÑƒÐ¿Ð¸Ð²ÑˆÐ°Ñ ÑÑƒÐ¼Ð¼Ð° ([CURRENCY_NAME])"/>
      <TfrxMemoView Name="Memo1" Left="933,54391" Top="0" Width="94,48825" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐžÑÑ‚Ð°Ñ‚Ð¾Ðº ([CURRENCY_NAME])"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Ïëàòåæè äîëæíèêîâ" Height="127" Left="334" Top="157" Width="342">
    <TBisEditControl Name="EditAgreement" Left="72" Top="8" Width="225" Height="21" Color="-16777192" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxButtonControl Name="ButtonAgreement" Left="304" Top="8" Width="23" Height="21" Hint="Âûáðàòü äîãîâîð" Caption="..." OnClick="ButtonAgreementOnClick"/>
    <TBisLabelControl Name="LabelDateBegin" Left="16" Top="39" Width="50" Height="13" Alignment="taRightJustify" Caption="Ïåðèîä ñ:" Color="-16777201" FocusControl="EditDateBegin"/>
    <TBisEditDateControl Name="EditDateBegin" Left="72" Top="36" Width="93" Height="21" Color="-16777192" Text="  .  .    "/>
    <TBisLabelControl Name="LabelDateEnd" Left="184" Top="40" Width="16" Height="13" Alignment="taRightJustify" Caption="ïî:" Color="-16777201" FocusControl="EditDateEnd"/>
    <TBisEditDateControl Name="EditDateEnd" Left="204" Top="36" Width="93" Height="21" Color="-16777211" Text="  .  .    "/>
    <TfrxButtonControl Name="ButtonPeriod" Left="304" Top="36" Width="23" Height="21" Hint="Âûáðàòü ïåðèîä" Caption="..." OnClick="ButtonPeriodOnClick"/>
    <TfrxButtonControl Name="ButtonOk" Left="172" Top="68" Width="75" Height="25" Caption="ÎÊ" Default="True" OnClick="ButtonOkOnClick"/>
    <TfrxButtonControl Name="ButtonCancel" Left="252" Top="68" Width="75" Height="25" Cancel="True" Caption="Îòìåíà" ModalResult="2"/>
    <TBisLabelControl Name="LabelAgreement" Left="20" Top="11" Width="47" Height="13" Alignment="taRightJustify" Caption="Äîãîâîð:" Color="-16777201" FocusControl="EditAgreement"/>
  </TfrxDialogPage>
</TBisFastReport>
