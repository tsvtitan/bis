unit BisDataTreeFm;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls, ComCtrls, ActnList,
  BisDataFm, BisFm, BisDataFrm, BisDataTreeFrm, BisDataGridFm;

type
  TBisDataTreeForm = class(TBisDataGridForm)
  private
    function GetDataFrame: TBisDataTreeFrame;
  protected
    class function GetDataFrameClass: TBisDataFrameClass; override;
  public
    constructor Create(AOwner: TComponent); override;

    property DataFrame: TBisDataTreeFrame read GetDataFrame;
  end;

  TBisDataTreeFormIface=class(TBisDataGridFormIface)
  private
    FViewFieldName: String;
    FKeyFieldNames: String;
    FParentFieldNames: String;
    function GetLastForm: TBisDataTreeForm;
  protected
    class function GetFormClass: TBisFormClass; override;
    function CreateForm: TBisForm; override;
  public
    property LastForm: TBisDataTreeForm read GetLastForm;
    property KeyFieldNames: String read FKeyFieldNames write FKeyFieldNames;
    property ParentFieldNames: String read FParentFieldNames write FParentFieldNames;
    property ViewFieldName: String read FViewFieldName write FViewFieldName;
  end;

var
  BisDataTreeForm: TBisDataTreeForm;

implementation

{$R *.dfm}

{ TBisDataTreeFormIface }

function TBisDataTreeFormIface.CreateForm: TBisForm;
begin
  Result:=inherited CreateForm;
  if Assigned(Result) then begin
    with LastForm do begin
      DataFrame.Tree.KeyFieldNames:=FKeyFieldNames;
      DataFrame.Tree.ParentFieldNames:=FParentFieldNames;
      DataFrame.Tree.ViewFieldName:=FViewFieldName;
    end;
  end;
end;

class function TBisDataTreeFormIface.GetFormClass: TBisFormClass;
begin
  Result:=TBisDataTreeForm;
end;

function TBisDataTreeFormIface.GetLastForm: TBisDataTreeForm;
begin
  Result:=TBisDataTreeForm(inherited LastForm);
end;

{ TBisDataTreeForm }

constructor TBisDataTreeForm.Create(AOwner: TComponent);
begin
  inherited Create(AOwner);
end;

function TBisDataTreeForm.GetDataFrame: TBisDataTreeFrame;
begin
  Result:=TBisDataTreeFrame(inherited DataFrame);
end;

class function TBisDataTreeForm.GetDataFrameClass: TBisDataFrameClass;
begin
  Result:=TBisDataTreeFrame;
end;

end.
