<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39645,6351349074" ReportOptions.Description.Text="" ReportOptions.LastChange="39646,4989393403" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  FAgreementId: Variant;                                &#13;&#10;  FPeriodType: TBisPeriodType;&#13;&#10;    &#13;&#10;procedure ButtonOkOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Index: Integer;&#13;&#10;  P: TBisProvider;                                     &#13;&#10;begin&#13;&#10;  Provider.Close;                       &#13;&#10;  Provider.Params.Clear;&#13;&#10;  Provider.Params.Add('AGREEMENT_ID',ptInput).Value:=FAgreementId;&#13;&#10;  Provider.Params.Add('DATE_BEGIN',ptInput).Value:=EditDateBegin.Date;&#13;&#10;  Provider.Params.Add('DATE_END',ptInput).Value:=EditDateEnd.Date;&#13;&#10;  Provider.Open;                &#13;&#10;  try                    &#13;&#10;    Chart.ClearSeries;&#13;&#10;    Index:=0;&#13;&#10;      &#13;&#10;    ProviderActions.Open;&#13;&#10;    ProviderActions.First;                    &#13;&#10;    while not ProviderActions.Eof do begin&#13;&#10;      Provider.Filter:=Format('ACTION_ID=%s',[QuotedStr(ProviderActions.FieldByName('ACTION_ID').AsString)]);&#13;&#10;      Provider.Filtered:=true;                                          &#13;&#10;      if Provider.RecordCount&#62;0 then begin                                                                               &#13;&#10;        Chart.AddSeries(csLine);&#13;&#10;        TLineSeries(Chart.Series[Index]).Pointer.Style:=psRectangle;&#13;&#10;        TLineSeries(Chart.Series[Index]).Pointer.Visible:=true;&#13;&#10;        TLineSeries(Chart.Series[Index]).LinePen.Width:=2;                              &#13;&#10;        TLineSeries(Chart.Series[Index]).Active:=false;                &#13;&#10;        TLineSeries(Chart.Series[Index]).Title:=ProviderActions.FieldByName('NAME').AsString;&#13;&#10;        TLineSeries(Chart.Series[Index]).ShowInLegend:=true;&#13;&#10;                                    &#13;&#10;  &#13;&#10;        P:=TBisProvider.Create(Data);&#13;&#10;        Data.AllObjects.Add(P);&#13;&#10;        P.Name:=Format('%s%d',['Provider',Index]);&#13;&#10;        Report.DataSets.Add(P);            &#13;&#10;        P.CreateTable(Provider);&#13;&#10;        P.CopyRecords(Provider);                                      &#13;&#10;  &#13;&#10;        Chart.SeriesData.Items[Index].DataSet:=P;&#13;&#10;        Chart.SeriesData.Items[Index].YSource:=Format('%s.&#34;%s&#34;',[P.Name,'ACTION_COUNT']);  &#13;&#10;        Chart.SeriesData.Items[Index].Source3:=Format('%s.&#34;%s&#34;',[P.Name,'DATE_WORK']);                      &#13;&#10;  //      Chart.SeriesData.Items[Index].XSource:=Format('%s.&#34;%s&#34;',[P.Name,'DATE_WORK']);                      &#13;&#10;        Chart.SeriesData.Items[Index].XType:=xtDate;&#13;&#10;&#13;&#10;        TLineSeries(Chart.Series[Index]).XValues.DateTime:=true;            &#13;&#10;        TLineSeries(Chart.Series[Index]).Active:=true;&#13;&#10;            &#13;&#10;        Inc(Index);&#13;&#10;      end;                  &#13;&#10;      ProviderActions.Next;                     &#13;&#10;    end;&#13;&#10;&#13;&#10;    if Index=0 then&#13;&#10;      Chart.AddSeries(csLine);                       &#13;&#10;      &#13;&#10;  finally&#13;&#10;    Provider.Filter:='';&#13;&#10;    Provider.Filtered:=false;                                            &#13;&#10;  end;            &#13;&#10;&#13;&#10;                                                      &#13;&#10;  DialogPage.ModalResult:=mrOk;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure ButtonAgreementOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  P: TBisProvider;&#13;&#10;  AgreementNum: String;&#13;&#10;  AgreementDate: String;                   &#13;&#10;begin&#13;&#10;  P:=TBisProvider.Create(nil);&#13;&#10;  try          &#13;&#10;    if DataSelectInto('Äîãîâîðû',P,'AGREEMENT_ID',FAgreementId) then begin&#13;&#10;      if P.Active and not P.IsEmpty then begin&#13;&#10;        FAgreementId:=P.FieldByName('AGREEMENT_ID').AsString;&#13;&#10;        AgreementNum:=P.FieldByName('NUM').AsString;&#13;&#10;        AgreementDate:=P.FieldByName('DATE_BEGIN').AsString;                                              &#13;&#10;        EditAgreement.Text:=AgreementNum+' îò '+AgreementDate+' '+P.FieldByName('FIRM_SMALL_NAME').AsString;&#13;&#10;        &#13;&#10;        Report.Variables['AGREEMENT_NUM']:=QuotedStr(AgreementNum);&#13;&#10;        Report.Variables['AGREEMENT_DATE']:=QuotedStr(AgreementDate);&#13;&#10;      end;                &#13;&#10;    end;&#13;&#10;  finally&#13;&#10;    P.Free;                                   &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;        &#13;&#10;procedure ButtonPeriodOnClick(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D1,D2: TDateTime;                                            &#13;&#10;begin&#13;&#10;  D1:=EditDateBegin.Date;&#13;&#10;  D2:=EditDateEnd.Date;                              &#13;&#10;  if PeriodSelect(FPeriodType,D1,D2) then begin&#13;&#10;    EditDateBegin.Date:=D1;&#13;&#10;    EditDateEnd.Date:=D2;                      &#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;  FAgreementId:=Null;                    &#13;&#10;  FPeriodType:=ptMonth;&#13;&#10;  EditAgreement.Color:=ColorControlReadOnly;&#13;&#10;  EditDateBegin.Color:=clWindow;                                      &#13;&#10;end." PropData="08446174617365747301010C2A00000020446174615365743D2250726F76696465722220446174615365744E616D653D2250726F76696465722200010C3800000020446174615365743D2250726F7669646572416374696F6E732220446174615365744E616D653D2250726F7669646572416374696F6E73220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C15000000204E616D653D2241475245454D454E545F4E554D2200010C16000000204E616D653D2241475245454D454E545F44415445220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="Provider" UserName="Provider" CloseDataSource="True" FieldAliases.Text="ACTION_ID=ACTION_ID&#13;&#10;DATE_WORK=DATE_WORK&#13;&#10;ACTION_NAME=ACTION_NAME&#13;&#10;ACTION_COUNT=ACTION_COUNT" ProviderName="ANALYSIS_ACTIVITY" FetchCount="-1" OpenMode="omExecute" PropData="05704C65667402680470546F700230"/>
    <TBisProvider Name="ProviderActions" UserName="ProviderActions" CloseDataSource="True" FieldAliases.Text="ACTION_ID=ACTION_ID&#13;&#10;NAME=NAME&#13;&#10;DESCRIPTION=DESCRIPTION&#13;&#10;PURPOSE=PURPOSE" ProviderName="S_ACTIONS" FetchCount="-1" Orders.PropData="064F72646572730106044E414D45020106000000" OpenMode="omOpen" PropData="05704C6566740390000470546F7003BC00"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxGroupHeader Name="GroupHeader" Height="18,89765" Left="0" Top="156" Width="699,21305" Condition="Provider.&#34;DATE_WORK&#34;">
      <TfrxMemoView Name="Memo13" Left="90,70872" Top="0" Width="514,01608" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo1" Left="90,70872" Top="0" Width="151,1812" Height="18,89765" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd.mm.yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="3" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;DATE_WORK&#34;]"/>
    </TfrxGroupHeader>
    <TfrxReportTitle Name="ReportTitle" Height="75,5906" Left="0" Top="16" Width="699,21305">
      <TfrxMemoView Name="Memo4" Left="113,3859" Top="0" Width="491,3389" Height="26,45671" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ½Ð°Ð»Ð¸Ð· Ð´ÐµÑÑ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð»Ð»-Ñ†ÐµÐ½Ñ‚Ñ€Ð°"/>
      <TfrxMemoView Name="Memo2" Left="113,3859" Top="49,13389" Width="491,3389" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [EditDateBegin.Text] Ð¿Ð¾ [EditDateEnd.Text]"/>
      <TfrxMemoView Name="Memo12" Left="113,3859" Top="26,45671" Width="491,3389" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" WordWrap="False" VAlign="vaCenter" Text="Ð¿Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñƒ Ð¿Ð¾Ñ€ÑƒÑ‡ÐµÐ½Ð¸Ñ â„– [AGREEMENT_NUM] Ð¾Ñ‚ [AGREEMENT_DATE]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter" Height="18,89765" Left="0" Top="756" Width="699,21305">
      <TfrxMemoView Name="Memo49" Left="502,67749" Top="0" Width="196,53556" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Page#] Ð¸Ð· [TotalPages#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData" Height="18,89765" Left="0" Top="196" Width="699,21305" ColumnWidth="0" ColumnGap="0" DataSet="Provider" DataSetName="Provider" RowCount="0">
      <TfrxMemoView Name="Memo7" Left="241,88992" Top="0" Width="226,7718" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="3" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;ACTION_NAME&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="468,66172" Top="0" Width="136,06308" Height="18,89765" DataField="ACTION_COUNT" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="#0" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="0" GapX="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Provider.&#34;ACTION_COUNT&#34;]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary" Height="408,18924" Left="0" Top="328" Width="699,21305">
      <TfrxChartView Name="Chart" Left="0" Top="18,89765" Width="699,21305" Height="389,29159" PropData="0543686172740AEE02000054504630085444424368617274054368617274044C656674020003546F7002000557696474680390010648656967687403FA00144261636B57616C6C2E50656E2E56697369626C650812426F74746F6D57616C6C2E56697369626C650814426F74746F6D417869732E496E6372656D656E74050000000000000080FF3F16426F74746F6D417869732E4C6162656C73416E676C65025A18426F74746F6D417869732E4D6178696D756D4F6666736574020A18426F74746F6D417869732E4D696E696D756D4F6666736574020A18426F74746F6D417869732E5469746C652E43617074696F6E120400000014043004420430040D4672616D652E56697369626C6508194C656674417869732E4178697356616C756573466F726D6174060123124C656674417869732E496E6372656D656E74050000000000000080FF3F164C656674417869732E4D6178696D756D4F6666736574020A164C656674417869732E4D696E696D756D4F6666736574020A164C656674417869732E5469746C652E43617074696F6E1425000000D09AD0BED0BBD0B8D187D0B5D181D182D0B2D0BE20D0B4D0B5D0B9D181D182D0B2D0B8D0B9124C6567656E642E4C6567656E645374796C6507086C735365726965730656696577334408165669657733444F7074696F6E732E526F746174696F6E02000A426576656C4F75746572070662764E6F6E6505436F6C6F720707636C5768697465000B544C696E655365726965730753657269657331194D61726B732E43616C6C6F75742E42727573682E436F6C6F720707636C426C61636B0D4D61726B732E56697369626C650816506F696E7465722E496E666C6174654D617267696E73090D506F696E7465722E5374796C65070B707352656374616E676C650F506F696E7465722E56697369626C65080C5856616C7565732E4E616D650601580D5856616C7565732E4F72646572070B6C6F417363656E64696E670C5956616C7565732E4E616D650601590D5956616C7565732E4F7264657207066C6F4E6F6E650000000E4368617274456C65766174696F6E0359010A5365726965734461746101010C3F0000002044617461547970653D2264744442446174612220536F72744F726465723D22736F4E6F6E652220546F704E3D2230222058547970653D22787444617465220000"/>
    </TfrxReportSummary>
    <TfrxFooter Name="Footer" Height="26,45671" Left="0" Top="280" Width="699,21305">
      <TfrxMemoView Name="Memo10" Left="404,40971" Top="7,55905999999999" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ñ‚Ð¾Ð³Ð¾:"/>
      <TfrxMemoView Name="Memo11" Left="468,66172" Top="7,55905999999999" Width="136,06308" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="#0" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" GapX="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Provider.&#34;ACTION_COUNT&#34;&#62;,MasterData)]"/>
    </TfrxFooter>
    <TfrxGroupFooter Name="GroupFooter" Height="22,67718" Left="0" Top="236" Width="699,21305">
      <TfrxMemoView Name="Memo16" Left="411,96877" Top="0" Width="56,69295" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="Ð’ÑÐµÐ³Ð¾:"/>
      <TfrxMemoView Name="Memo9" Left="468,66172" Top="0" Width="136,06308" Height="18,89765" DataSet="Provider" DataSetName="Provider" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="#0" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" GapX="3" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Provider.&#34;ACTION_COUNT&#34;&#62;,MasterData)]"/>
      <TfrxLineView Name="Line1" Left="411,96877" Top="0" Width="192,75603" Height="0" Frame.Typ="4"/>
    </TfrxGroupFooter>
    <TfrxHeader Name="Header" Height="22,67718" Left="0" Top="112" Width="699,21305" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo3" Left="90,70872" Top="0" Width="151,1812" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð°"/>
      <TfrxMemoView Name="Memo5" Left="241,88992" Top="0" Width="226,7718" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ðµ"/>
      <TfrxMemoView Name="Memo6" Left="468,66172" Top="0" Width="136,06308" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Àíàëèç äåÿòåëüíîñòè êîëë-öåíòðà" Height="127" Left="334" Top="157" Width="342">
    <TBisEditControl Name="EditAgreement" Left="72" Top="8" Width="225" Height="21" Color="-16777192" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
    <TfrxButtonControl Name="ButtonAgreement" Left="304" Top="8" Width="23" Height="21" Hint="Âûáðàòü äîãîâîð" Caption="..." OnClick="ButtonAgreementOnClick"/>
    <TBisLabelControl Name="LabelDateBegin" Left="16" Top="39" Width="50" Height="13" Alignment="taRightJustify" Caption="Ïåðèîä ñ:" Color="-16777201" FocusControl="EditDateBegin"/>
    <TBisEditDateControl Name="EditDateBegin" Left="72" Top="36" Width="93" Height="21" Color="-16777192" Text="  .  .    "/>
    <TBisLabelControl Name="LabelDateEnd" Left="184" Top="40" Width="16" Height="13" Alignment="taRightJustify" Caption="ïî:" Color="-16777201" FocusControl="EditDateEnd"/>
    <TBisEditDateControl Name="EditDateEnd" Left="204" Top="36" Width="93" Height="21" Color="-16777211" Text="  .  .    "/>
    <TfrxButtonControl Name="ButtonPeriod" Left="304" Top="36" Width="23" Height="21" Hint="Âûáðàòü ïåðèîä" Caption="..." OnClick="ButtonPeriodOnClick"/>
    <TfrxButtonControl Name="ButtonOk" Left="172" Top="68" Width="75" Height="25" Caption="ÎÊ" Default="True" OnClick="ButtonOkOnClick"/>
    <TfrxButtonControl Name="ButtonCancel" Left="252" Top="68" Width="75" Height="25" Cancel="True" Caption="Îòìåíà" ModalResult="2"/>
    <TBisLabelControl Name="LabelAgreement" Left="20" Top="11" Width="47" Height="13" Alignment="taRightJustify" Caption="Äîãîâîð:" Color="-16777201" FocusControl="EditAgreement"/>
  </TfrxDialogPage>
</TBisFastReport>
