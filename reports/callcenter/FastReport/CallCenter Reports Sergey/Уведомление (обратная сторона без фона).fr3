<?xml version="1.0" encoding="utf-8"?>
<TBisFastReport Version="4.1.40" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="1535" PreviewOptions.Zoom="1" PreviewOptions.ZoomMode="zmPageWidth" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39562,614438287" ReportOptions.Description.Text="" ReportOptions.LastChange="39622,7467983218" ScriptLanguage="PascalScript" ScriptText.Text="Procedure FillAddressComboBox;&#13;&#10;Begin&#13;&#10;  AddressComboBox.Items.Clear;&#13;&#10;  AddressComboBox.Items.Add('Адрес прописки');&#13;&#10;  AddressComboBox.Items.Add('Адрес фактический');&#13;&#10;  AddressComboBox.Items.Add('Адрес дополнительный');&#13;&#10;  AddressComboBox.Items.Add('Адрес работы');&#13;&#10;  OKButton.Enabled:=False;                                                    &#13;&#10;End;&#13;&#10;&#13;&#10;procedure AddressComboBoxOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  OKButton.Enabled:=True;  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DebtorsButtonOnClick(Sender: TfrxComponent);&#13;&#10;var DebId, DealNum: String;&#13;&#10;  S: String;&#13;&#10;  F: TBisFilterGroup;&#13;&#10;  P: Integer;                           &#13;&#10;begin&#13;&#10;  if (DealsEdit.Text&#60;&#62;'') Then Begin&#13;&#10;    S:=DealsEdit.Text;                                 &#13;&#10;    Delete(S,1,16);&#13;&#10;    P:=Pos(' ',S);          &#13;&#10;    S:=Copy(S,1,P-2);                            &#13;&#10;  End Else&#13;&#10;    S:='';                           &#13;&#10;  if DataSelectInto('Кредитные дела',DealsProvider,'DEAL_NUM',S) then begin&#13;&#10;    DebId:=DealsProvider.FieldByName('DEBTOR_ID').AsString;&#13;&#10;    DealNum:=DealsProvider.FieldByName('DEAL_NUM').AsString;&#13;&#10;    DebtorsProvider.Close;                      &#13;&#10;    DebtorsProvider.FilterGroups.Clear;                      &#13;&#10;    F:=DebtorsProvider.FilterGroups.Add;        &#13;&#10;    F.Filters.Add('DEBTOR_ID',fcEqual,DebId);&#13;&#10;    DebtorsProvider.Open;&#13;&#10;    DealsEdit.Text:='Кредитное дело №'+DealNum+'. '+&#13;&#10;                    DebtorsProvider.FieldByName('SURNAME_IP').AsString+' '+&#13;&#10;                    DebtorsProvider.FieldByName('NAME_IP').AsString+' '+&#13;&#10;                    DebtorsProvider.FieldByName('PATRONYMIC_IP').AsString;  &#13;&#10;    FillAddressComboBox;                                                                    &#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;Var&#13;&#10;  DialogVisible: Variant;&#13;&#10;  S: Variant;&#13;&#10;  Str: TStringList;&#13;&#10;  DealFilterGroup, F: TBisFilterGroup;&#13;&#10;  I: Integer;&#13;&#10;  DealId: String;                                   &#13;&#10;&#13;&#10;Begin                                                          &#13;&#10;  DialogVisible:=Report.Calc('DIALOG_VISIBLE');                                          &#13;&#10;&#13;&#10;  If (DialogVisible=0) Then Begin&#13;&#10;    DealsEdit.Enabled:=False;&#13;&#10;    DebtorsButton.Enabled:=False;&#13;&#10;    DealsLabel.Enabled:=False;&#13;&#10;    FillAddressComboBox;&#13;&#10;&#13;&#10;    try&#13;&#10;      Str:=TStringList.Create;          &#13;&#10;                &#13;&#10;      S:=Report.Calc('DEAL_IDS');                    &#13;&#10;&#13;&#10;      GetStringsByString(S,';',Str);&#13;&#10;      DealsProvider.FilterGroups.Clear;&#13;&#10;      DealFilterGroup:=DealsProvider.FilterGroups.Add;            &#13;&#10;          &#13;&#10;      for I:=0 to Str.Count-1 do begin&#13;&#10;        DealId:=Str.Strings[I];                                    &#13;&#10;        DealFilterGroup.Filters.Add('DEAL_ID',fcEqual,DealId).Operator:=foOr;                                                         &#13;&#10;      end;&#13;&#10;           &#13;&#10;       DebtorsProvider.FilterGroups.Clear;                      &#13;&#10;       F:=DebtorsProvider.FilterGroups.Add;                           &#13;&#10;       DealsProvider.Open;                         &#13;&#10;       DealsProvider.First;                                                 &#13;&#10;       for I:=0 to Str.Count-1 do begin                                  &#13;&#10;         F.Filters.Add('DEBTOR_ID',fcEqual,DealsProvider.FieldByName('DEBTOR_ID').AsString).Operator:=foOr;                                                                       &#13;&#10;         DealsProvider.Next;                                                 &#13;&#10;       end;                   &#13;&#10;       DebtorsProvider.Open;                                      &#13;&#10;          &#13;&#10;    finally&#13;&#10;      Str.Free;&#13;&#10;    End;&#13;&#10;      &#13;&#10;  End;            &#13;&#10;End.&#13;&#10;  " PropData="08446174617365747301010C3800000020446174615365743D22446562746F727350726F76696465722220446174615365744E616D653D22446562746F727350726F76696465722200010C3400000020446174615365743D224465616C7350726F76696465722220446174615365744E616D653D224465616C7350726F7669646572220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C16000000204E616D653D224449414C4F475F56495349424C452200010C10000000204E616D653D224445414C5F494453220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TBisProvider Name="DebtorsProvider" UserName="DebtorsProvider" CloseDataSource="True" FieldAliases.Text="DEBTOR_ID=DEBTOR_ID&#13;&#10;DEBTOR_TYPE=DEBTOR_TYPE&#13;&#10;SURNAME_IP=SURNAME_IP&#13;&#10;NAME_IP=NAME_IP&#13;&#10;PATRONYMIC_IP=PATRONYMIC_IP&#13;&#10;SURNAME_DP=SURNAME_DP&#13;&#10;NAME_DP=NAME_DP&#13;&#10;PATRONYMIC_DP=PATRONYMIC_DP&#13;&#10;PASSPORT=PASSPORT&#13;&#10;SEX=SEX&#13;&#10;DATE_BIRTH=DATE_BIRTH&#13;&#10;PLACE_BIRTH=PLACE_BIRTH&#13;&#10;ADDRESS_RESIDENCE=ADDRESS_RESIDENCE&#13;&#10;INDEX_RESIDENCE=INDEX_RESIDENCE&#13;&#10;ADDRESS_ACTUAL=ADDRESS_ACTUAL&#13;&#10;INDEX_ACTUAL=INDEX_ACTUAL&#13;&#10;ADDRESS_ADDITIONAL=ADDRESS_ADDITIONAL&#13;&#10;INDEX_ADDITIONAL=INDEX_ADDITIONAL&#13;&#10;JOB_TITLE=JOB_TITLE&#13;&#10;PLACE_WORK=PLACE_WORK&#13;&#10;ADDRESS_WORK=ADDRESS_WORK&#13;&#10;INDEX_WORK=INDEX_WORK&#13;&#10;PHONE_HOME=PHONE_HOME&#13;&#10;PHONE_WORK=PHONE_WORK&#13;&#10;PHONE_MOBILE=PHONE_MOBILE&#13;&#10;PHONE_OTHER1=PHONE_OTHER1&#13;&#10;PHONE_OTHER2=PHONE_OTHER2&#13;&#10;FOUNDERS=FOUNDERS" ProviderName="S_DEBTORS_DP" FetchCount="-1" PropData="05704C65667402300470546F700224"/>
    <TBisProvider Name="DealsProvider" UserName="DealsProvider" CloseDataSource="True" FieldAliases.Text="DEAL_ID=DEAL_ID&#13;&#10;GROUP_ID=GROUP_ID&#13;&#10;AGREEMENT_ID=AGREEMENT_ID&#13;&#10;DEBTOR_ID=DEBTOR_ID&#13;&#10;DEAL_NUM=DEAL_NUM&#13;&#10;DATE_ISSUE=DATE_ISSUE&#13;&#10;DATE_CLOSE=DATE_CLOSE&#13;&#10;ACCOUNT_NUM=ACCOUNT_NUM&#13;&#10;ARREAR_PERIOD=ARREAR_PERIOD&#13;&#10;INITIAL_DEBT=INITIAL_DEBT&#13;&#10;DEBT_INFORMATION=DEBT_INFORMATION&#13;&#10;GUARANTORS=GUARANTORS&#13;&#10;PLAN_ID=PLAN_ID&#13;&#10;DEBTOR_NUM=DEBTOR_NUM&#13;&#10;DEBTOR_DATE=DEBTOR_DATE" ProviderName="DEALS" FetchCount="-1" PropData="05704C656674022C0470546F70038400"/>
  </TfrxDataPage>
  <TfrxReportPage Name="InformationPage" PaperWidth="124,1" PaperHeight="98,8" PaperSize="256" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxGroupHeader Name="GroupHeader1" Height="0" Left="0" Top="18,89765" Width="469,039673" Condition="DebtorsProvider.&#34;DEBTOR_ID&#34;" StartNewPage="True"/>
    <TfrxMasterData Name="MasterData1" Height="331" Left="0" Top="41,57483" Width="469,039673" ColumnWidth="0" ColumnGap="0" DataSet="DebtorsProvider" DataSetName="DebtorsProvider" RowCount="0">
      <TfrxMemoView Name="Memo1" Left="85,13389" Top="32,23624" Width="64,25201" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="Р·/Рї СЃ Рї/С†РІ."/>
      <TfrxMemoView Name="Memo2" Left="104,14966" Top="55,91342" Width="113,3859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-12" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="РљСЂР°СЃРЅРѕСЏСЂСЃРєР° 118"/>
      <TfrxMemoView Name="DebtorFIOMemo" Left="153,04731" Top="113,3859" Width="291,02381" Height="15,11812" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[DebtorsProvider.&#34;SURNAME_DP&#34;] [DebtorsProvider.&#34;NAME_DP&#34;] [DebtorsProvider.&#34;PATRONYMIC_DP&#34;]"/>
      <TfrxMemoView Name="AddressMemo" Left="180,37013" Top="130,28355" Width="264,5671" Height="30,23624" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,&#60;DebtorsProvider.&#34;ADDRESS_RESIDENCE&#34;&#62;,IIF(AddressComboBox.ItemIndex=1,&#60;DebtorsProvider.&#34;ADDRESS_ACTUAL&#34;&#62;,IIF(AddressComboBox.ItemIndex=2,&#60;DebtorsProvider.&#34;ADDRESS_ADDITIONAL&#34;&#62;,&#60;DebtorsProvider.&#34;ADDRESS_WORK&#34;&#62;)))]"/>
      <TfrxMemoView Name="Index1Memo" Left="73,5906" Top="126,50402" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,1,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,1,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,1,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,1,1))))]"/>
      <TfrxMemoView Name="Index2Memo" Left="89,70872" Top="126,61417323" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,2,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,2,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,2,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,2,1))))]"/>
      <TfrxMemoView Name="Index3Memo" Left="106,82684" Top="126,72449" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,3,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,3,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,3,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,3,1))))]"/>
      <TfrxMemoView Name="Index4Memo" Left="122,94496" Top="126,72449" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,4,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,4,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,4,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,4,1))))]"/>
      <TfrxMemoView Name="Index5Memo" Left="140,06308" Top="126,72449" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,5,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,5,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,5,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,5,1))))]"/>
      <TfrxMemoView Name="Index6Memo" Left="156,74026" Top="126,72449" Width="11,33859" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="-16777208" Font.Height="-16" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[IIF(AddressComboBox.ItemIndex=0,Copy(&#60;DebtorsProvider.&#34;INDEX_RESIDENCE&#34;&#62;,6,1),IIF(AddressComboBox.ItemIndex=1,Copy(&#60;DebtorsProvider.&#34;INDEX_ACTUAL&#34;&#62;,6,1),IIF(AddressComboBox.ItemIndex=2,Copy(&#60;DebtorsProvider.&#34;INDEX_ADDITIONAL&#34;&#62;,6,1),Copy(&#60;DebtorsProvider.&#34;INDEX_WORK&#34;&#62;,6,1))))]"/>
    </TfrxMasterData>
  </TfrxReportPage>
  <TfrxDialogPage Name="DebtorsDialogPage" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Отчет &#34;Уведомление (обратная сторона без фона)&#34;" Height="182" Left="265" Top="150" Width="531">
    <TfrxGroupBoxControl Name="DebtorsGroupBox" Left="4" Top="4" Width="513" Height="113" Caption="Выбор кредитного дела и адреса" Color="-16777201">
      <TBisLabelControl Name="DealsLabel" Left="12" Top="36" Width="84" Height="13" Caption="Кредитное дело" Color="-16777201" FocusControl="DealsEdit"/>
      <TBisLabelControl Name="AddressLabel" Left="64" Top="67" Width="31" Height="13" Caption="Адрес" Color="-16777201" FocusControl="AddressComboBox"/>
      <TBisComboBoxControl Name="AddressComboBox" Left="104" Top="64" Width="393" Height="21" Color="-16777192" Items.Text="" Style="csDropDownList" ItemIndex="-1" OnChange="AddressComboBoxOnChange"/>
      <TBisEditControl Name="DealsEdit" Left="104" Top="32" Width="365" Height="21" Color="-16777211" MaxLength="0" PasswordChar="0" ReadOnly="True"/>
      <TfrxButtonControl Name="DebtorsButton" Left="476" Top="32" Width="21" Height="21" Caption="..." OnClick="DebtorsButtonOnClick"/>
    </TfrxGroupBoxControl>
    <TfrxButtonControl Name="CancelButton" Left="442" Top="124" Width="75" Height="25" Caption="Отмена" ModalResult="2"/>
    <TfrxButtonControl Name="OKButton" Left="360" Top="124" Width="75" Height="25" Enabled="False" Caption="OK" ModalResult="1" OnClick="OKButtonOnClick"/>
  </TfrxDialogPage>
</TBisFastReport>
